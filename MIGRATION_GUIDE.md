# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏ DataTrace –≤ –µ–¥–∏–Ω–æ–µ Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

## üìã –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- **–î–æ**: –î–≤–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞ (API –Ω–∞ Express + Web –Ω–∞ Next.js)
- **–ü–æ—Å–ª–µ**: –ï–¥–∏–Ω–æ–µ Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å API Routes

### 2. –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### API Endpoints (apps/web/app/api/)
- ‚úÖ `/api/health` - Health check
- ‚úÖ `/api/auth/signin` - –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
- ‚úÖ `/api/auth/signup` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- ‚è≥ `/api/search` - –ü–æ–∏—Å–∫ —É—Ç–µ—á–µ–∫ (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏)
- ‚è≥ `/api/company-search` - –ü–æ–∏—Å–∫ –∫–æ–º–ø–∞–Ω–∏–π (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏)

#### –°–µ—Ä–≤–∏—Å—ã –∏ —É—Ç–∏–ª–∏—Ç—ã (apps/web/lib/)
- ‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –∏–∑ `apps/api/src/services/` –≤ `apps/web/lib/services/`
- ‚úÖ –í—Å–µ —É—Ç–∏–ª–∏—Ç—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –∏–∑ `apps/api/src/utils/` –≤ `apps/web/lib/utils/`
- ‚úÖ Middleware —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –∏–∑ `apps/api/src/middleware/` –≤ `apps/web/lib/middleware/`
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Supabase —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ `apps/web/lib/config/`

#### –ù–æ–≤—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚úÖ `/search` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∏—Å–∫–∞ —É—Ç–µ—á–µ–∫ (–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –≤ Next.js)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `/dashboard` - —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ `/search`

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

#### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- `railway.json` - –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –¥–µ–ø–ª–æ—è web –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `apps/web/package.json` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ API
- `apps/web/.env.example` - –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- –£–¥–∞–ª–µ–Ω `Procfile` - –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é –Ω–∞ Railway

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
# –ö–æ–º–º–∏—Ç –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
git add .
git commit -m "Migrate to unified Next.js architecture"
git push origin main
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Railway –ø—Ä–æ–µ–∫—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç –≤ Railway Dashboard
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Settings ‚Üí General
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ **Root Directory**: –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º (–∫–æ—Ä–µ–Ω—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)
4. **Build Command**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ railway.json
5. **Start Command**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ railway.json

### –®–∞–≥ 3: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í Railway Dashboard ‚Üí Variables –¥–æ–±–∞–≤—å—Ç–µ:

```env
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
NODE_ENV=production
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key

# API –∫–ª—é—á–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ —É—Ç–µ—á–µ–∫
ITP_TOKEN=your_itp_token
DYXLESS_TOKEN=your_dyxless_token
LEAKOSINT_TOKEN=your_leakosint_token
USERSBOX_TOKEN=your_usersbox_token
VEKTOR_TOKEN=your_vektor_token

# API –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–º–ø–∞–Ω–∏–π
DATANEWTON_KEY=your_datanewton_key
CHECKO_KEY=your_checko_key

# DeepSeek AI (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
DEEPSEEK_API_KEY=your_deepseek_key

# Snusbase (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
SNUSBASE_API_KEY=your_snusbase_key
```

### –®–∞–≥ 4: –î–µ–ø–ª–æ–π

1. –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–Ω–µ—Ç –¥–µ–ø–ª–æ–π
2. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

## üîß –ß—Ç–æ –µ—â–µ –Ω—É–∂–Ω–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å

### –ö—Ä–∏—Ç–∏—á–Ω–æ:
1. **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è CommonJS –≤ ES Modules**
   - –í—Å–µ —Ñ–∞–π–ª—ã –≤ `apps/web/lib/` –Ω—É–∂–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑ `.js` –≤ `.ts`
   - –ó–∞–º–µ–Ω–∏—Ç—å `require()` –Ω–∞ `import`
   - –ó–∞–º–µ–Ω–∏—Ç—å `module.exports` –Ω–∞ `export`

2. **–°–æ–∑–¥–∞–Ω–∏–µ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è API endpoints**
   - `/api/search/route.ts`
   - `/api/company-search/route.ts`
   - `/api/snusbase/[...path]/route.ts`
   - –ò –¥—Ä—É–≥–∏–µ endpoints –∏–∑ `apps/api/src/index.js`

3. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**
   ```bash
   cd apps/web
   npm install
   ```

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å TypeScript —Ç–∏–ø—ã –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
2. –î–æ–±–∞–≤–∏—Ç—å error boundaries
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
4. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã

## üìù –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **Health check**: `https://your-app.railway.app/api/health`
2. **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞**: `https://your-app.railway.app/`
3. **–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É**: `https://your-app.railway.app/login`
4. **–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç**: `https://your-app.railway.app/dashboard`
5. **–ü–æ–∏—Å–∫ —É—Ç–µ—á–µ–∫**: `https://your-app.railway.app/search`

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **TypeScript –æ—à–∏–±–∫–∏** - –Ω–æ—Ä–º–∞–ª—å–Ω–æ, Next.js –≤—Å–µ —Ä–∞–≤–Ω–æ —Å–æ–±–µ—Ä–µ—Ç –ø—Ä–æ–µ–∫—Ç
2. **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ API endpoints** - –Ω—É–∂–Ω–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å
3. **CORS** - –Ω–µ –Ω—É–∂–µ–Ω, —Ç–∞–∫ –∫–∞–∫ –≤—Å–µ –Ω–∞ –æ–¥–Ω–æ–º –¥–æ–º–µ–Ω–µ

## üîÑ –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:

```bash
# –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
git revert HEAD
git push origin main

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—É—é –≤–µ—Ç–∫—É
git checkout old-working-branch
git push origin main
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Railway Dashboard
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `apps/web/` —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã

---

**–í–∞–∂–Ω–æ**: –≠—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏—è —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É API –∏ Web –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏, –æ–±—ä–µ–¥–∏–Ω—è—è –∏—Ö –≤ –µ–¥–∏–Ω–æ–µ Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –¢–µ–ø–µ—Ä—å —É –≤–∞—Å –æ–¥–∏–Ω –ø—Ä–æ–µ–∫—Ç, –æ–¥–∏–Ω –¥–µ–ø–ª–æ–π, –∏ –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º —Å CORS!