<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DataTrace ‚Äî –ü–æ–∏—Å–∫ —É—Ç–µ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö v2.0</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=PT+Mono:wght@400&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'PT Mono', monospace;
      background: white;
      color: black;
      margin: 0;
      line-height: 1.6;
    }
    
    .container {
      max-width: 880px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    /* –ö–Ω–æ–ø–∫–∏ –≤ —Å—Ç–∏–ª–µ –ª–µ–Ω–¥–∏–Ω–≥–∞ */
    .btn-primary {
      background: black;
      color: white;
      border: 2px solid black;
      padding: 14px 24px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      font-family: 'PT Mono', monospace;
      text-transform: uppercase;
      font-size: 14px;
      letter-spacing: 0.5px;
    }
    
    .btn-primary:hover:not(:disabled) {
      background: white;
      color: black;
    }
    
    .btn-primary:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    
    .btn-secondary {
      background: transparent;
      color: black;
      border: 2px solid #e5e7eb;
      padding: 8px 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      font-family: 'PT Mono', monospace;
      font-size: 12px;
      text-transform: uppercase;
    }
    
    .btn-secondary:hover {
      border-color: black;
    }
    
    .btn-secondary.active {
      border-color: black;
      background: black;
      color: white;
    }
    
    /* –ü–æ–ª—è –≤–≤–æ–¥–∞ */
    .input-field {
      background: white;
      color: black;
      border: 2px solid #e5e7eb;
      padding: 14px 16px;
      font-family: 'PT Mono', monospace;
      transition: border-color 0.2s;
      flex: 1;
      font-size: 15px;
      width: 100%;
      max-width: 400px;
      min-width: 320px;
    }
    
    .input-field:focus {
      outline: none;
      border-color: black;
    }
    
    .select-field {
      background: white;
      color: black;
      border: 2px solid #e5e7eb;
      padding: 14px 16px;
      font-family: 'PT Mono', monospace;
      min-width: 200px;
      font-size: 15px;
    }
    
    .select-field:focus {
      outline: none;
      border-color: black;
    }
    
    /* –ö–∞—Ä—Ç–æ—á–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
    .result-card {
      background: white;
      border: 2px solid #e5e7eb;
      padding: 24px;
      margin-bottom: 16px;
      transition: all 0.2s;
    }
    
    .result-card:hover {
      border-color: black;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .result-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
      margin-bottom: 16px;
    }
    
    .result-title {
      font-weight: 600;
      font-size: 18px;
      letter-spacing: 0.2px;
    }
    
    .status-badge {
      padding: 6px 12px;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .status-clean {
      background: #dcfce7;
      color: #166534;
      border: 1px solid #bbf7d0;
    }
    
    .status-found {
      background: #fef2f2;
      color: #dc2626;
      border: 1px solid #fecaca;
    }
    
    .status-error {
      background: #fefce8;
      color: #ca8a04;
      border: 1px solid #fde047;
    }
    
    .result-body {
      display: none;
      padding-top: 16px;
      border-top: 1px solid #e5e7eb;
    }
    
    .result-card.open .result-body {
      display: block;
    }
    
    .caret {
      transition: transform 0.2s ease;
      font-size: 14px;
      color: #6b7280;
    }
    
    .result-card.open .caret {
      transform: rotate(90deg);
    }
    
    /* –ü—Ä–æ–≥—Ä–µ—Å—Å */
    .progress-container {
      margin: 32px 0;
      padding: 24px;
      background: #f9fafb;
      border: 2px solid #e5e7eb;
      display: none;
    }
    
    .progress-bar {
      width: 100%;
      height: 8px;
      background: #e5e7eb;
      overflow: hidden;
      margin-bottom: 16px;
    }
    
    .progress-fill {
      height: 100%;
      background: black;
      transition: width 0.3s ease;
      width: 0%;
    }
    
    .progress-text {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 14px;
    }
    
    .progress-percent {
      font-weight: 600;
    }
    
    /* –î–∞–Ω–Ω—ã–µ */
    .data-grid {
      display: grid;
      grid-template-columns: 180px 1fr;
      gap: 12px 16px;
      margin-top: 16px;
    }
    
    .data-label {
      font-weight: 600;
      color: #6b7280;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .data-value {
      color: black;
      word-break: break-word;
      font-size: 14px;
    }
    
    /* –ò—Ç–æ–≥–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ */
    .summary-container {
      margin-top: 32px;
      padding: 24px;
      background: #f9fafb;
      border: 2px solid #e5e7eb;
      display: none;
    }
    
    .summary-title {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 16px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    /* –§—É—Ç–µ—Ä */
    .footer-section {
      margin-top: 48px;
      padding: 32px;
      background: black;
      color: white;
    }
    
    .footer-title {
      font-weight: 600;
      margin-bottom: 16px;
      font-size: 18px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .footer-text {
      font-size: 14px;
      line-height: 1.6;
    }
    
    .footer-text div {
      margin-bottom: 8px;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è */
    .formatted-profile {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      margin-bottom: 20px;
    }

    .profile-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 24px;
    }

    .profile-header h2 {
      color: white !important;
    }

    .view-toggle-btn {
      background: rgba(255, 255, 255, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: white;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .view-toggle-btn:hover {
      background: rgba(255, 255, 255, 0.3);
      border-color: rgba(255, 255, 255, 0.4);
    }

    .view-toggle-btn.active {
      background: white;
      color: #667eea;
      border-color: white;
      font-weight: 600;
    }

    .profile-content {
      padding: 24px;
    }

    .profile-text {
      font-size: 16px;
      line-height: 1.8;
      color: #374151;
    }

    .profile-text h3, .profile-text h4 {
      margin-top: 24px;
      margin-bottom: 12px;
      color: #1f2937;
      font-weight: 700;
    }

    .profile-text p {
      margin-bottom: 12px;
    }

    .profile-text ul {
      margin: 12px 0;
      padding-left: 0;
    }

    .profile-text li {
      margin-bottom: 8px;
      padding: 8px 0;
      border-bottom: 1px solid #f3f4f6;
      list-style: none;
    }

    .profile-text li:last-child {
      border-bottom: none;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .loading-spinner {
      border: 3px solid #f3f4f6;
      border-top: 3px solid #3b82f6;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      margin: 0 auto;
    }

    /* AI Loading Overlay */
    .ai-loading-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      z-index: 9999;
      align-items: center;
      justify-content: center;
    }

    .ai-loading-content {
      background: white;
      padding: 40px;
      border-radius: 16px;
      text-align: center;
      max-width: 420px;
      margin: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .ai-loading-title {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #1f2937;
    }

    .ai-loading-subtitle {
      font-size: 14px;
      color: #6b7280;
      margin-bottom: 32px;
    }

    .ai-spinner {
      width: 50px;
      height: 50px;
      margin: 0 auto 24px;
      border: 4px solid #f3f4f6;
      border-top: 4px solid #3b82f6;
      border-radius: 50%;
      animation: ai-spin 1s linear infinite;
    }

    @keyframes ai-spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .ai-progress-dots {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-bottom: 20px;
    }

    .ai-dot {
      width: 10px;
      height: 10px;
      background: #3b82f6;
      border-radius: 50%;
      animation: ai-bounce 1.4s ease-in-out infinite both;
    }

    .ai-dot:nth-child(1) { animation-delay: -0.32s; }
    .ai-dot:nth-child(2) { animation-delay: -0.16s; }
    .ai-dot:nth-child(3) { animation-delay: 0s; }

    @keyframes ai-bounce {
      0%, 80%, 100% { 
        transform: scale(0.6); 
        opacity: 0.5; 
      }
      40% { 
        transform: scale(1.2); 
        opacity: 1; 
      }
    }

    .ai-status-text {
      font-size: 14px;
      color: #4b5563;
      font-weight: 500;
    }

    /* Utility classes */
    .flex {
      display: flex;
    }
    
    .items-center {
      align-items: center;
    }
    
    .gap-3 {
      gap: 12px;
    }

    /* Nothing OS Dashboard Styles */
    .dashboard-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background: #000000;
      min-height: 100vh;
      font-family: 'PT Mono', monospace;
      color: #ffffff;
    }

    .dashboard-header {
      background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
      border: 2px solid #ffffff;
      padding: 40px;
      margin-bottom: 30px;
      position: relative;
      overflow: hidden;
    }

    .dashboard-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #ff0000 0%, #ffffff 50%, #ff0000 100%);
    }

    .dashboard-title {
      color: #ffffff;
      margin-bottom: 30px;
    }

    .dashboard-title h1 {
      font-size: 32px;
      font-weight: 700;
      color: #ffffff !important;
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .dashboard-title p {
      font-size: 16px;
      color: #cccccc;
      line-height: 1.6;
    }

    .dashboard-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .stat-card {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 20px;
      text-align: center;
      position: relative;
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: #ff0000;
    }

    .stat-number {
      font-size: 28px;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 8px;
    }

    .stat-label {
      font-size: 12px;
      color: #cccccc;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .risk-indicator {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 30px 0;
    }

    .risk-circle {
      width: 150px;
      height: 150px;
      border: 3px solid #333333;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      position: relative;
      background: #000000;
      padding: 10px;
      box-sizing: border-box;
    }

    .risk-circle.high-risk {
      border-color: #ff0000;
      box-shadow: 0 0 30px rgba(255, 0, 0, 0.3);
    }

    .risk-circle.medium-risk {
      border-color: #ffffff;
      box-shadow: 0 0 30px rgba(255, 255, 255, 0.2);
    }

    .risk-circle.low-risk {
      border-color: #ffffff;
      box-shadow: 0 0 30px rgba(255, 255, 255, 0.1);
    }

    .risk-level {
      font-size: 10px;
      font-weight: 700;
      color: #ffffff;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      text-align: center;
      line-height: 1.1;
      word-spacing: 2px;
      margin-top: 4px;
    }

    .risk-count {
      font-size: 32px;
      font-weight: 700;
      color: #ff0000;
      margin-bottom: 6px;
      line-height: 1;
    }

    .action-section {
      background: #000000;
      border: 2px solid #ff0000;
      padding: 30px;
      margin-bottom: 30px;
      text-align: center;
      position: relative;
    }

    .action-section::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      background: linear-gradient(45deg, #ff0000, #ffffff, #ff0000);
      z-index: -1;
      opacity: 0.1;
    }

    .action-section h2 {
      color: #ff0000 !important;
      font-size: 20px;
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .action-section p {
      color: #cccccc;
      margin-bottom: 20px;
    }

    .action-buttons {
      display: flex;
      gap: 16px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .nothing-btn {
      background: #ffffff;
      color: #000000;
      border: 2px solid #ffffff;
      padding: 12px 24px;
      font-family: 'PT Mono', monospace;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .nothing-btn:hover {
      background: #000000;
      color: #ffffff;
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
    }

    .nothing-btn.danger {
      background: #ff0000;
      color: #ffffff;
      border-color: #ff0000;
    }

    .nothing-btn.danger:hover {
      background: #ffffff;
      color: #ff0000;
      box-shadow: 0 0 20px rgba(255, 0, 0, 0.3);
    }

    .breaches-section {
      background: #000000;
      border: 1px solid #333333;
      margin-bottom: 30px;
    }

    .breaches-section h2 {
      color: #ffffff !important;
      padding: 24px;
      margin: 0;
      font-size: 18px;
      text-transform: uppercase;
      letter-spacing: 1px;
      border-bottom: 1px solid #333333;
    }

    .breaches-section > p {
      padding: 16px 24px;
      color: #cccccc;
      margin: 0;
      border-bottom: 1px solid #333333;
    }

    .table-filters {
      padding: 20px 24px;
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      border-bottom: 1px solid #333333;
    }

    .nothing-filter-btn {
      background: transparent;
      color: #cccccc;
      border: 1px solid #333333;
      padding: 8px 16px;
      font-family: 'PT Mono', monospace;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .nothing-filter-btn:hover {
      border-color: #ffffff;
      color: #ffffff;
    }

    .nothing-filter-btn.active {
      background: #ffffff;
      color: #000000;
      border-color: #ffffff;
    }

    .nothing-table {
      width: 100%;
      border-collapse: collapse;
      background: #000000;
    }

    .nothing-table th {
      background: #1a1a1a;
      color: #ffffff;
      padding: 16px 24px;
      text-align: left;
      font-weight: 600;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
      border-bottom: 1px solid #333333;
    }

    .nothing-table td {
      padding: 16px 24px;
      border-bottom: 1px solid #1a1a1a;
      color: #cccccc;
      vertical-align: middle;
    }

    .nothing-table tr:hover {
      background: rgba(255, 255, 255, 0.02);
    }

    .source-info {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .source-icon {
      width: 40px;
      height: 40px;
      background: #1a1a1a;
      border: 1px solid #333333;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
    }

    .source-name {
      font-weight: 600;
      color: #ffffff;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .source-description {
      font-size: 11px;
      color: #666666;
      text-transform: uppercase;
    }

    .nothing-status-badge {
      padding: 6px 12px;
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      border: 1px solid;
    }

    .status-breach {
      background: rgba(255, 0, 0, 0.1);
      color: #ff0000;
      border-color: #ff0000;
    }

    .status-clean {
      background: rgba(255, 255, 255, 0.1);
      color: #ffffff;
      border-color: #ffffff;
    }

    .status-error {
      background: rgba(255, 255, 255, 0.05);
      color: #cccccc;
      border-color: #666666;
    }

    .nothing-details-btn {
      background: transparent;
      border: 1px solid #333333;
      color: #cccccc;
      padding: 6px 12px;
      font-family: 'PT Mono', monospace;
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 1px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .nothing-details-btn:hover {
      border-color: #ffffff;
      color: #ffffff;
    }

    .view-toggle-container {
      background: #000000;
      padding: 20px 0;
      text-align: center;
      border-bottom: 1px solid #333333;
      margin-bottom: 30px;
    }

    .view-toggle-buttons {
      display: inline-flex;
      border: 1px solid #333333;
      background: #000000;
    }

    .view-toggle-btn {
      background: transparent !important;
      color: #cccccc !important;
      border: none !important;
      padding: 12px 24px !important;
      font-family: 'PT Mono', monospace !important;
      font-size: 12px !important;
      text-transform: uppercase !important;
      letter-spacing: 1px !important;
      cursor: pointer !important;
      transition: all 0.3s ease !important;
      border-right: 1px solid #333333 !important;
    }

    .view-toggle-btn:last-child {
      border-right: none !important;
    }

    .view-toggle-btn:hover {
      background: rgba(255, 255, 255, 0.05) !important;
      color: #ffffff !important;
    }

    .view-toggle-btn.active {
      background: #ffffff !important;
      color: #000000 !important;
    }

    /* Nothing OS Modal Styles */
    .nothing-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .nothing-modal-content {
      background: #000000;
      border: 2px solid #ffffff;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      position: relative;
    }

    .nothing-modal-header {
      padding: 24px;
      border-bottom: 1px solid #333333;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #1a1a1a;
    }

    .nothing-modal-header h3 {
      color: #ffffff !important;
      margin: 0;
      font-size: 16px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .nothing-modal-close {
      background: none;
      border: none;
      color: #cccccc;
      font-size: 24px;
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .nothing-modal-close:hover {
      color: #ff0000;
    }

    .nothing-modal-body {
      padding: 24px;
      color: #ffffff;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö */
    .data-grid {
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: 8px 16px;
      color: #ffffff;
    }

    .data-label {
      font-weight: 600;
      color: #cccccc !important;
      text-transform: uppercase;
      font-size: 12px;
      letter-spacing: 0.5px;
    }

    .data-value {
      color: #ffffff !important;
      font-family: 'PT Mono', monospace;
      word-break: break-all;
      background: rgba(255, 255, 255, 0.05);
      padding: 4px 8px;
      border-radius: 2px;
    }

    .data-value:empty::after {
      content: '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö';
      color: #666666;
      font-style: italic;
    }

    /* Nothing OS Animations */
    @keyframes nothing-pulse {
      0% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.4); }
      70% { box-shadow: 0 0 0 20px rgba(255, 0, 0, 0); }
      100% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0); }
    }

    .pulse-red {
      animation: nothing-pulse 2s infinite;
    }

    @keyframes nothing-glow {
      0%, 100% { box-shadow: 0 0 5px rgba(255, 255, 255, 0.2); }
      50% { box-shadow: 0 0 20px rgba(255, 255, 255, 0.4); }
    }

    .glow-white {
      animation: nothing-glow 3s ease-in-out infinite;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ –ø–æ –¥–æ–º–µ–Ω—É */
    .domain-results {
      margin-top: 20px;
    }

    .database-group {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .database-group h4 {
      color: #2c3e50;
      background: rgba(255, 255, 255, 0.9);
      padding: 8px 12px;
      border-radius: 6px;
      margin-bottom: 15px;
      font-family: 'PT Mono', monospace;
      font-size: 16px;
      font-weight: bold;
      border-left: 4px solid #2c3e50;
    }

    .records-preview {
      margin-top: 15px;
    }

    .record-item {
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 6px;
      padding: 12px;
      margin-bottom: 12px;
      font-family: 'PT Mono', monospace;
    }

    .record-email {
      color: #ff6b6b;
      font-weight: bold;
      margin-bottom: 8px;
      font-size: 14px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      padding-bottom: 6px;
    }

    .record-details {
      margin: 8px 0;
    }

    .record-field {
      margin: 4px 0;
      padding: 3px 0;
      font-size: 12px;
      line-height: 1.4;
    }

    .record-field strong {
      color: #2c3e50;
      display: inline-block;
      min-width: 100px;
    }

    .password-hidden {
      background: rgba(255, 107, 107, 0.2);
      color: #ff6b6b;
      padding: 2px 4px;
      border-radius: 3px;
      font-family: monospace;
    }

    .hash-preview {
      background: rgba(255, 206, 84, 0.2);
      color: #ffce54;
      padding: 2px 4px;
      border-radius: 3px;
      font-family: monospace;
    }

    .record-meta {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 8px;
      padding-top: 6px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .leak-source {
      background: rgba(44, 62, 80, 0.2);
      color: #2c3e50;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 10px;
      text-transform: uppercase;
    }

    .db-stats {
      margin-bottom: 15px;
      padding: 10px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 5px;
    }

    .data-types-summary {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      margin-top: 8px;
    }

    .data-type-badge {
      background: rgba(44, 62, 80, 0.2);
      color: #2c3e50;
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: bold;
    }

    .data-type-badge.critical {
      background: rgba(255, 107, 107, 0.2);
      color: #ff6b6b;
    }

    .data-type-badge.warning {
      background: rgba(255, 206, 84, 0.2);
      color: #ffce54;
    }

    .leak-type {
      background: rgba(255, 107, 107, 0.2);
      color: #ff6b6b;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .more-results {
      color: #cccccc;
      font-style: italic;
      margin-top: 10px;
      text-align: center;
    }
  </style>
</head>

<body>
  <!-- Header –≤ —Å—Ç–∏–ª–µ –ª–µ–Ω–¥–∏–Ω–≥–∞ -->
  <header class="border-b-2 border-gray-200">
    <div class="container py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-2">
          <svg class="h-8 w-8" fill="currentColor" viewBox="0 0 24 24">
            <path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z"/>
          </svg>
          <span class="text-xl font-bold">DataTrace</span>
        </div>
        <div class="flex items-center space-x-4">
          <div id="userInfo" class="hidden">
            <span id="userEmail" class="text-sm"></span>
            <button id="logoutBtn" class="btn-secondary ml-2">–í—ã–π—Ç–∏</button>
          </div>
          <button id="corporateBtn" class="btn-primary">üè¢ –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ç–∞—Ä–∏—Ñ</button>
          <button id="loginBtn" class="btn-secondary">–í–æ–π—Ç–∏</button>
        </div>
      </div>
    </div>
  </header>

  <!-- Auth Modal -->
  <div id="authModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-white max-w-md w-full p-6 border-2 border-black">
        <div class="flex justify-between items-center mb-6">
          <h2 id="authTitle" class="text-xl font-bold">–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
          <button id="closeAuthModal" class="text-2xl">&times;</button>
        </div>
        
        <div id="authError" class="hidden mb-4 p-3 bg-red-100 border border-red-400 text-red-700"></div>
        <div id="authSuccess" class="hidden mb-4 p-3 bg-green-100 border border-green-400 text-green-700"></div>
        
        <form id="authForm">
          <div class="mb-4">
            <label class="block text-sm font-bold mb-2">Email</label>
            <input id="authEmail" type="email" class="input-field w-full" required>
          </div>
          
          <div class="mb-4">
            <label class="block text-sm font-bold mb-2">–ü–∞—Ä–æ–ª—å</label>
            <input id="authPassword" type="password" class="input-field w-full" required>
          </div>
          
          <div class="mb-6">
            <button id="authSubmit" type="submit" class="btn-primary w-full">–í–æ–π—Ç–∏</button>
          </div>
          
          <div class="text-center">
            <button id="authToggle" type="button" class="text-sm underline">
              –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="container py-16">
    <!-- Hero Section -->
    <div class="text-center mb-16">
      <h1 id="heroTitle" class="text-5xl font-bold text-black leading-tight mb-6">
        –ü–æ–∏—Å–∫ —É—Ç–µ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö
      </h1>
      <p id="heroDescription" class="text-xl text-gray-600 mb-8 max-w-2xl mx-auto">
        –ü—Ä–æ–≤–µ—Ä–∏–º –≤–∞—à–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –≤—Å–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º —É—Ç–µ—á–µ–∫ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–º –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
      </p>
    </div>

    <!-- Search Form -->
    <div class="max-w-4xl mx-auto">
      <!-- Mode Selection -->
      <div class="flex gap-3 mb-8 justify-center flex-wrap">
        <button id="modeLeaks" class="btn-secondary active">–ü–æ–∏—Å–∫ —É—Ç–µ—á–µ–∫</button>
        <button id="modePassword" class="btn-secondary">üîê –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
      </div>

      <!-- Search Input -->
      <div id="searchInput" class="flex gap-4 mb-8 flex-wrap">
        <select id="field" class="select-field">
          <option value="phone">–¢–µ–ª–µ—Ñ–æ–Ω</option>
          <option value="email">Email</option>
          <option value="vk">VK</option>
          <option value="ok">–û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏</option>
          <option value="inn">–ò–ù–ù</option>
          <option value="snils">–°–ù–ò–õ–°</option>
        </select>
        <input id="q" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: +79990000000" class="input-field" />
        <button id="btn" class="btn-primary">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
      </div>

      <!-- Password Check Input -->
      <div id="passwordInput" class="hidden mb-8">
        <div class="max-w-2xl mx-auto">
          <div class="mb-4">
            <label class="block text-sm font-bold mb-2">–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏</label>
            <div class="relative">
              <input id="passwordField" type="password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å..." class="input-field w-full pr-12" />
              <button id="togglePassword" type="button" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-black">
                üëÅÔ∏è
              </button>
            </div>
          </div>
          <div class="mb-4">
            <div id="passwordStrength" class="text-sm text-gray-600"></div>
          </div>
          <div class="text-center">
            <button id="checkPasswordBtn" class="btn-primary">üîê –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
          </div>
          <div class="mt-4 text-xs text-gray-500 text-center">
            <p>‚ö†Ô∏è –ü–∞—Ä–æ–ª—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ö–µ—à. –°–∞–º –ø–∞—Ä–æ–ª—å –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä.</p>
          </div>
        </div>
      </div>

      <!-- Progress -->
      <div id="progressContainer" class="progress-container">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-text">
          <span id="progressStatus">–û–∂–∏–¥–∞–Ω–∏–µ...</span>
          <span id="progressPercent" class="progress-percent">0%</span>
        </div>
      </div>

      <!-- Results -->
      <div id="results"></div>
    </div>

    <!-- Footer Info -->
    <div class="footer-section">
      <div class="max-w-4xl mx-auto">
        <div class="footer-title">–£–¥–∞–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</div>
        <div class="footer-text">
          <div>1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö</div>
          <div>2. –í—ã–±–µ—Ä–∏—Ç–µ "–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å"</div>
          <div>3. –ù–∞–∂–º–∏—Ç–µ "–°–∫—Ä—ã—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é"</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Corporate Interface -->
  <div id="corporateInterface" class="hidden">
    <!-- Corporate Header -->
    <header class="border-b-2 border-gray-200" style="background: linear-gradient(135deg, #1f2937 0%, #374151 100%);">
      <div class="container py-4">
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-2">
            <svg class="h-8 w-8 text-white" fill="currentColor" viewBox="0 0 24 24">
              <path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z"/>
            </svg>
            <span class="text-xl font-bold text-white">DataTrace Corporate</span>
          </div>
          <div class="flex items-center space-x-4">
            <div id="corporateUserInfo" class="hidden">
              <span id="corporateUserEmail" class="text-sm text-gray-300"></span>
              <button id="corporateLogoutBtn" class="btn-secondary ml-2" style="color: white; border-color: white;">–í—ã–π—Ç–∏</button>
            </div>
            <button id="backToMainBtn" class="btn-secondary" style="color: white; border-color: white;">‚Üê –ù–∞–∑–∞–¥</button>
            <button id="corporateLoginBtn" class="btn-primary" style="background: white; color: #1f2937;">–í–æ–π—Ç–∏</button>
          </div>
        </div>
      </div>
    </header>

    <!-- Corporate Main Content -->
    <div class="container py-16" style="background: linear-gradient(to bottom, #f8fafc 0%, #ffffff 100%); min-height: calc(100vh - 80px);">
      <!-- Corporate Hero Section -->
      <div class="text-center mb-16">
        <div class="inline-flex items-center justify-center p-3 mb-6" style="background: linear-gradient(135deg, #1f2937 0%, #374151 100%); border-radius: 50%; width: 80px; height: 80px;">
          <svg class="h-10 w-10 text-white" fill="currentColor" viewBox="0 0 24 24">
            <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
          </svg>
        </div>
        <h1 class="text-5xl font-bold text-gray-900 leading-tight mb-6">
          –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
        </h1>
        <p class="text-xl text-gray-600 mb-8 max-w-3xl mx-auto">
          –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —É—Ç–µ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        </p>
        
        <!-- Corporate Features -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12 max-w-5xl mx-auto">
          <div class="p-6 bg-white border-2 border-gray-200 hover:border-gray-900 transition-colors">
            <div class="text-3xl mb-4">üè¢</div>
            <h3 class="text-lg font-bold mb-2">–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–∞–Ω–∏–π</h3>
            <p class="text-gray-600 text-sm">–ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏</p>
          </div>
          <div class="p-6 bg-white border-2 border-gray-200 hover:border-gray-900 transition-colors">
            <div class="text-3xl mb-4">üë•</div>
            <h3 class="text-lg font-bold mb-2">–ê–Ω–∞–ª–∏–∑ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</h3>
            <p class="text-gray-600 text-sm">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ —Å–ª–µ–¥–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –∏ –≤—ã—è–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–æ–≤</p>
          </div>
          <div class="p-6 bg-white border-2 border-gray-200 hover:border-gray-900 transition-colors">
            <div class="text-3xl mb-4">üìä</div>
            <h3 class="text-lg font-bold mb-2">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ 24/7</h3>
            <p class="text-gray-600 text-sm">–ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —É—Ç–µ—á–µ–∫ –∏ —É–≥—Ä–æ–∑</p>
          </div>
        </div>
      </div>

      <!-- Corporate Search Form -->
      <div class="max-w-4xl mx-auto">
        <!-- Corporate Mode Selection -->
        <div class="flex gap-3 mb-8 justify-center flex-wrap">
          <button id="corpModeCompany" class="btn-secondary active">üè¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–º–ø–∞–Ω–∏—é</button>
          <button id="corpModeEmployee" class="btn-secondary">üë§ –ê–Ω–∞–ª–∏–∑ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</button>
          <button id="corpModeDomain" class="btn-secondary">üåê –ü–æ–∏—Å–∫ –ø–æ –¥–æ–º–µ–Ω—É</button>
          <button id="corpModeBatch" class="btn-secondary">üìã –ú–∞—Å—Å–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞</button>
        </div>

        <!-- Company Search Input -->
        <div id="corporateSearchInput" class="max-w-2xl mx-auto mb-8">
          <div class="bg-white p-8 border-2 border-gray-200 hover:border-gray-900 transition-colors">
            <h3 class="text-xl font-bold mb-6 text-center">–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–∞–Ω–∏–∏</h3>
            <div class="space-y-4">
              <div>
                <label class="block text-sm font-bold mb-2">–ò–ù–ù –∫–æ–º–ø–∞–Ω–∏–∏</label>
                <input id="corporateInn" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –ò–ù–ù..." class="input-field w-full" />
              </div>
              <div>
                <label class="block text-sm font-bold mb-2">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                <input id="corporateName" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û–û–û '–†–æ–≥–∞ –∏ –∫–æ–ø—ã—Ç–∞'..." class="input-field w-full" />
              </div>
              <div class="text-center pt-4">
                <button id="corporateSearchBtn" class="btn-primary w-full">üîç –ù–∞—á–∞—Ç—å –∞–Ω–∞–ª–∏–∑</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Employee Search Input -->
        <div id="employeeSearchInput" class="hidden max-w-2xl mx-auto mb-8">
          <div class="bg-white p-8 border-2 border-gray-200 hover:border-gray-900 transition-colors">
            <h3 class="text-xl font-bold mb-6 text-center">–ê–Ω–∞–ª–∏–∑ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h3>
            <div class="space-y-4">
              <div>
                <label class="block text-sm font-bold mb-2">–¢–∏–ø –¥–∞–Ω–Ω—ã—Ö</label>
                <select id="employeeField" class="select-field w-full">
                  <option value="phone">–¢–µ–ª–µ—Ñ–æ–Ω</option>
                  <option value="email">Email</option>
                  <option value="fullname">–§–ò–û</option>
                  <option value="vk">VK –ø—Ä–æ—Ñ–∏–ª—å</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-bold mb-2">–î–∞–Ω–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</label>
                <input id="employeeData" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ..." class="input-field w-full" />
              </div>
              <div class="text-center pt-4">
                <button id="employeeSearchBtn" class="btn-primary w-full">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Domain Search Input -->
        <div id="domainSearchInput" class="hidden max-w-2xl mx-auto mb-8">
          <div class="bg-white p-8 border-2 border-gray-200 hover:border-gray-900 transition-colors">
            <h3 class="text-xl font-bold mb-6 text-center">–ü–æ–∏—Å–∫ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —É—Ç–µ—á–µ–∫ –ø–æ –¥–æ–º–µ–Ω—É</h3>
            <div class="space-y-4">
              <div>
                <label class="block text-sm font-bold mb-2">–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –¥–æ–º–µ–Ω</label>
                <input id="domainName" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: company.com" class="input-field w-full" />
              </div>
              <div class="bg-blue-50 border border-blue-200 p-4 rounded">
                <div class="text-sm text-blue-800">
                  <strong>üîç –ß—Ç–æ –º—ã –Ω–∞–π–¥–µ–º:</strong>
                  <ul class="mt-2 list-disc list-inside text-blue-700">
                    <li>–í—Å–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ email –∞–¥—Ä–µ—Å–∞ –≤ —É—Ç–µ—á–∫–∞—Ö</li>
                    <li>–ü–∞—Ä–æ–ª–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏–∑ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö</li>
                    <li>–°–ø–∏—Å–æ–∫ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã—Ö –±–∞–∑ —É—Ç–µ—á–µ–∫</li>
                    <li>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</li>
                  </ul>
                </div>
              </div>
              <div class="text-center pt-4">
                <button id="domainSearchBtn" class="btn-primary w-full">üåê –ù–∞–π—Ç–∏ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —É—Ç–µ—á–∫–∏</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Batch Search Input -->
        <div id="batchSearchInput" class="hidden max-w-2xl mx-auto mb-8">
          <div class="bg-white p-8 border-2 border-gray-200 hover:border-gray-900 transition-colors">
            <h3 class="text-xl font-bold mb-6 text-center">–ú–∞—Å—Å–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞</h3>
            <div class="space-y-4">
              <div>
                <label class="block text-sm font-bold mb-2">–°–ø–∏—Å–æ–∫ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏</label>
                <textarea id="batchData" placeholder="–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É):&#10;+79991234567&#10;ivan@company.com&#10;+79995556677" class="input-field w-full h-32 resize-none"></textarea>
              </div>
              <div class="text-xs text-gray-500">
                üí° –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è: —Ç–µ–ª–µ—Ñ–æ–Ω—ã, email, –ò–ù–ù. –ú–∞–∫—Å–∏–º—É–º 100 –∑–∞–ø–∏—Å–µ–π –∑–∞ —Ä–∞–∑.
              </div>
              <div class="text-center pt-4">
                <button id="batchSearchBtn" class="btn-primary w-full">üìä –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∞—Å—Å–æ–≤—É—é –ø—Ä–æ–≤–µ—Ä–∫—É</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Corporate Progress -->
        <div id="corporateProgressContainer" class="progress-container">
          <div class="progress-bar">
            <div class="progress-fill" id="corporateProgressFill"></div>
          </div>
          <div class="progress-text">
            <span id="corporateProgressStatus">–û–∂–∏–¥–∞–Ω–∏–µ...</span>
            <span id="corporateProgressPercent" class="progress-percent">0%</span>
          </div>
        </div>

        <!-- Corporate Results -->
        <div id="corporateResults"></div>
      </div>

      <!-- Corporate Footer -->
      <div class="footer-section" style="background: linear-gradient(135deg, #1f2937 0%, #374151 100%);">
        <div class="max-w-4xl mx-auto">
          <div class="footer-title" style="color: white;">–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</div>
          <div class="footer-text" style="color: #d1d5db;">
            <div>üìû –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞: +7 (800) 123-45-67</div>
            <div>üìß Email: corporate@datatrace.ru</div>
            <div>üïê –†–∞–±–æ—Ç–∞–µ–º 24/7 –¥–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // –û—Å–Ω–æ–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
    const q = document.getElementById('q');
    const fieldSel = document.getElementById('field');
    const btn = document.getElementById('btn');
    const modeLeaks = document.getElementById('modeLeaks');
    const modePassword = document.getElementById('modePassword');
    const results = document.getElementById('results');
    
    // Password check elements
    const searchInput = document.getElementById('searchInput');
    const passwordInput = document.getElementById('passwordInput');
    const passwordField = document.getElementById('passwordField');
    const togglePassword = document.getElementById('togglePassword');
    const passwordStrength = document.getElementById('passwordStrength');
    const checkPasswordBtn = document.getElementById('checkPasswordBtn');

    // Authentication elements
    const loginBtn = document.getElementById('loginBtn');
    const logoutBtn = document.getElementById('logoutBtn');
    const userInfo = document.getElementById('userInfo');
    const userEmail = document.getElementById('userEmail');
    const authModal = document.getElementById('authModal');
    const closeAuthModal = document.getElementById('closeAuthModal');
    const authForm = document.getElementById('authForm');
    const authTitle = document.getElementById('authTitle');
    const authSubmit = document.getElementById('authSubmit');
    const authToggle = document.getElementById('authToggle');
    const authError = document.getElementById('authError');
    const authSuccess = document.getElementById('authSuccess');

    // Authentication state
    let currentUser = null;
    let authToken = null;
    let isLoginMode = true;

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤
    let currentMode = 'leaks';

    // ===== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ê–ë–û–¢–´ –° –£–¢–ï–ß–ö–ê–ú–ò (–æ–ø—Ä–µ–¥–µ–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–µ) =====
    window.displayLeakResultsBySources = async function(sourceResults) {
      console.log('üé® Displaying results with Nothing OS dashboard option');
      
      if (!sourceResults || sourceResults.length === 0) {
        results.innerHTML = '<div class="result-card"><div style="color: #dc2626;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</div></div>';
        return;
      }

      // –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–µ–∂–∏–º–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Å—Ç–∏–ª–µ Nothing OS
      const viewToggle = document.createElement('div');
      viewToggle.className = 'view-toggle-container';
      viewToggle.innerHTML = `
        <div class="view-toggle-buttons">
          <button id="listViewBtn" class="view-toggle-btn active">–°–ü–ò–°–û–ö –ò–°–¢–û–ß–ù–ò–ö–û–í</button>
          <button id="dashboardViewBtn" class="view-toggle-btn">–î–ê–®–ë–û–†–î</button>
        </div>
      `;
      
      results.innerHTML = '';
      results.appendChild(viewToggle);
      
      const resultsContainer = document.createElement('div');
      resultsContainer.id = 'resultsContainer';
      results.appendChild(resultsContainer);

      // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫
      showNothingListView(sourceResults, resultsContainer);

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
      document.getElementById('listViewBtn').addEventListener('click', () => {
        switchNothingView('list', sourceResults, resultsContainer);
      });
      
      document.getElementById('dashboardViewBtn').addEventListener('click', () => {
        switchNothingView('dashboard', sourceResults, resultsContainer);
      });
    };

    function switchNothingView(viewType, sourceResults, container) {
      document.querySelectorAll('.view-toggle-btn').forEach(btn => btn.classList.remove('active'));
      
      if (viewType === 'dashboard') {
        document.getElementById('dashboardViewBtn').classList.add('active');
        window.displayNothingDashboard(sourceResults);
      } else {
        document.getElementById('listViewBtn').classList.add('active');
        showNothingListView(sourceResults, container);
      }
    }

    function showNothingListView(sourceResults, container) {
      container.innerHTML = '';
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è AI –∞–Ω–∞–ª–∏–∑–∞
      const hasAnyData = sourceResults.some(result => 
        result.ok && result.items && window.checkIfSourceHasLeakData(result, result.name)
      );

      // AI –∞–Ω–∞–ª–∏–∑ –±–ª–æ–∫
      if (hasAnyData) {
        const aiAnalysisContainer = document.createElement('div');
        aiAnalysisContainer.className = 'result-card';
        aiAnalysisContainer.style.textAlign = 'center';
        aiAnalysisContainer.style.backgroundColor = '#f8fafc';
        aiAnalysisContainer.style.border = '2px dashed #cbd5e1';
        
        aiAnalysisContainer.innerHTML = `
          <div style="padding: 20px;">
            <div style="font-size: 18px; font-weight: 600; margin-bottom: 10px;">ü§ñ –ê–Ω–∞–ª–∏–∑ –ò–ò</div>
            <div style="color: #64748b; margin-bottom: 15px;">
              –ü–æ–ª—É—á–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —É—Ç–µ—á–µ–∫, –æ—Ü–µ–Ω–∫—É –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
            </div>
            <button id="getAIAnalysis" class="btn-primary" style="margin: 0 auto;">
              üìä –ü–æ–ª—É—á–∏—Ç—å –ò–ò –∞–Ω–∞–ª–∏–∑
            </button>
            <div id="aiAnalysisResult" style="display: none; margin-top: 20px;"></div>
          </div>
        `;
        
        container.appendChild(aiAnalysisContainer);

        document.getElementById('getAIAnalysis').addEventListener('click', async () => {
          await performAIAnalysis(sourceResults);
        });
      }

      // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤  
      sourceResults.forEach((result, index) => {
        const sourceName = result.name || `–ò—Å—Ç–æ—á–Ω–∏–∫ ${index + 1}`;
        let status = 'success';
        
        if (result.error) {
          status = 'warning';
        } else if (result.ok && result.items) {
          const hasData = window.checkIfSourceHasLeakData(result, sourceName);
          if (hasData) {
            status = 'danger';
          }
        }
        
        const item = createResultItem(sourceName, status, result.items || result.error, false, sourceName);
        container.appendChild(item);
      });
    };

    // –§—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ò–ò –∞–Ω–∞–ª–∏–∑–∞
    async function performAIAnalysis(sourceResults) {
      // –ò—â–µ–º –∫–Ω–æ–ø–∫—É AI –∞–Ω–∞–ª–∏–∑–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å –≤ —Å–ø–∏—Å–∫–µ –∏–ª–∏ –¥–∞—à–±–æ—Ä–¥–µ)
      let button = document.getElementById('getAIAnalysis') || document.getElementById('nothingAIBtn');
      let resultDiv = document.getElementById('aiAnalysisResult');
      
      // –ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –≤ –¥–∞—à–±–æ—Ä–¥–µ, —Å–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
      if (!resultDiv && button && button.id === 'nothingAIBtn') {
        resultDiv = document.createElement('div');
        resultDiv.id = 'aiAnalysisResult';
        resultDiv.style.marginTop = '20px';
        button.parentNode.appendChild(resultDiv);
      }
      
      if (button) {
        button.disabled = true;
        button.innerHTML = 'üîÑ –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ...';
      }
      
      try {
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–æ–ª—å—à–æ–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è DeepSeek V3 –∞–Ω–∞–ª–∏–∑–∞ (120 —Å–µ–∫—É–Ω–¥)
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 120000);
        
        const response = await fetch('/api/ai-leak-analysis', {
          method: 'POST',
          headers: createAuthHeaders(),
          body: JSON.stringify({
            query: q.value.trim(),
            field: fieldSel.value,
            results: sourceResults
          }),
          signal: controller.signal
        });

        clearTimeout(timeoutId);
        const data = await response.json();
        
        if (data.ok && data.analysis) {
          displayAIAnalysis(data.analysis, resultDiv);
          if (button) {
            button.style.display = 'none';
          }
          if (resultDiv) {
            resultDiv.style.display = 'block';
          }
        } else {
          throw new Error(data.error || '–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞');
        }
      } catch (error) {
        if (error.name === 'AbortError') {
          console.error('AI Analysis timeout after 120 seconds');
          if (button) button.innerHTML = '‚è±Ô∏è –¢–∞–π–º–∞—É—Ç –∞–Ω–∞–ª–∏–∑–∞ (120—Å)';
        } else {
          console.error('AI Analysis error:', error);
          if (button) button.innerHTML = '‚ùå –û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞';
        }
        if (button) button.disabled = false;
        
        setTimeout(() => {
          if (button) {
            const isNothingBtn = button.id === 'nothingAIBtn';
            button.innerHTML = isNothingBtn ? 'ü§ñ –ê–ù–ê–õ–ò–ó –£–ì–†–û–ó –ò–ò' : 'üìä –ü–æ–ª—É—á–∏—Ç—å –ò–ò –∞–Ω–∞–ª–∏–∑';
          }
        }, 3000);
      }
    }

    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ò–ò –∞–Ω–∞–ª–∏–∑–∞
    function convertMarkdownTablesToHTML(content) {
      // –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è markdown —Ç–∞–±–ª–∏—Ü –æ—Ç DeepSeek V3
      const tableRegex = /(\|[^\n]*\|\s*\n)+/g;
      
      return content.replace(tableRegex, (match) => {
        console.log('üîç Found markdown table:', match);
        
        const lines = match.trim().split('\n').filter(line => line.includes('|') && line.trim().length > 0);
        
        if (lines.length < 2) {
          console.log('‚ùå Not enough lines for table');
          return match;
        }
        
        // –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ - –∑–∞–≥–æ–ª–æ–≤–∫–∏
        const headerLine = lines[0];
        const headerCells = headerLine.split('|')
          .map(cell => cell.trim())
          .filter(cell => cell.length > 0);
        
        console.log('üìã Header cells:', headerCells);
        
        // –ù–∞—Ö–æ–¥–∏–º —Å—Ç—Ä–æ–∫—É —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏ (–º–æ–∂–µ—Ç –±—ã—Ç—å –≤—Ç–æ—Ä–∞—è –∏–ª–∏ –ª—é–±–∞—è —Å --- –∏–ª–∏ |---|)
        let dataStartIndex = 1;
        for (let i = 1; i < lines.length; i++) {
          if (lines[i].includes('---') || lines[i].includes(':---') || lines[i].includes('---|') || lines[i].includes('|---')) {
            dataStartIndex = i + 1;
            break;
          }
        }
        
        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ - –¥–∞–Ω–Ω—ã–µ
        const dataRows = lines.slice(dataStartIndex)
          .map(line => {
            const cells = line.split('|').map(cell => cell.trim()).filter(cell => cell.length > 0);
            return cells;
          })
          .filter(row => row.length > 0);
        
        console.log('üìä Data rows:', dataRows);
        
        // –°–æ–∑–¥–∞–µ–º HTML —Ç–∞–±–ª–∏—Ü—É
        let html = '<table style="width: 100%; border-collapse: collapse; margin: 16px 0; border: 1px solid #e2e8f0; border-radius: 8px; overflow: hidden; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;">';
        
        // –ó–∞–≥–æ–ª–æ–≤–∫–∏
        if (headerCells.length > 0) {
          html += '<thead><tr>';
          headerCells.forEach(header => {
            html += `<th style="background: #f8fafc; font-weight: 600; color: #374151; padding: 12px; border: 1px solid #e2e8f0; text-align: left;">${header}</th>`;
          });
          html += '</tr></thead>';
        }
        
        // –î–∞–Ω–Ω—ã–µ
        if (dataRows.length > 0) {
          html += '<tbody>';
          dataRows.forEach(row => {
            html += '<tr>';
            row.forEach(cell => {
              html += `<td style="padding: 12px; border: 1px solid #e2e8f0; color: #374151; vertical-align: top;">${cell}</td>`;
            });
            html += '</tr>';
          });
          html += '</tbody>';
        }
        
        html += '</table>';
        console.log('‚úÖ Generated HTML table');
        return html;
      });
    }

    function displayAIAnalysis(analysis, container) {
      console.log('üéØ displayAIAnalysis called!');
      console.log('üìä Analysis type:', typeof analysis);
      console.log('üìù Analysis preview:', typeof analysis === 'string' ? analysis.substring(0, 200) + '...' : analysis);
      console.log('üì¶ Container element:', container);
      
      let html = '<div style="text-align: left; background: white; padding: 20px; border-radius: 8px; border: 1px solid #e2e8f0;">';
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø –∞–Ω–∞–ª–∏–∑–∞ - —Å—Ç—Ä–æ–∫–∞ (DeepSeek V3) –∏–ª–∏ –æ–±—ä–µ–∫—Ç (—Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç)
      if (typeof analysis === 'string') {
        // DeepSeek V3 –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≥–æ—Ç–∏–≤—ã–π —Ç–µ–∫—Å—Ç - –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º markdown –≤ HTML
        // üîß –í–ê–ñ–ù–û: –°–Ω–∞—á–∞–ª–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —Ç–∞–±–ª–∏—Ü—ã (–ø–æ–∫–∞ –µ—Å—Ç—å \n), –ø–æ—Ç–æ–º –æ—Å—Ç–∞–ª—å–Ω–æ–µ!
        let htmlContent = convertMarkdownTablesToHTML(analysis);
        
        // –ü–æ—Ç–æ–º –¥–µ–ª–∞–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–º–µ–Ω—ã
        htmlContent = htmlContent
          .replace(/\n/g, '<br>')
          .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
          .replace(/### (.*?)(<br>|$)/g, '<h3 style="color: #1f2937; margin: 20px 0 10px 0; font-size: 18px; font-weight: 600;">$1</h3>')
          .replace(/## (.*?)(<br>|$)/g, '<h2 style="color: #1f2937; margin: 24px 0 12px 0; font-size: 20px; font-weight: 700;">$1</h2>')
          .replace(/# (.*?)(<br>|$)/g, '<h1 style="color: #1f2937; margin: 28px 0 14px 0; font-size: 24px; font-weight: 800;">$1</h1>');

        html += `
          <div style="color: #374151; line-height: 1.6; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
            ${htmlContent}
          </div>
        `;
      } else if (typeof analysis === 'object' && analysis !== null) {
        // –°—Ç–∞—Ä—ã–π –æ–±—ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç - –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
        
        // –£—Ä–æ–≤–µ–Ω—å –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏
        if (analysis.risk_level) {
          const riskColors = {
            'low': '#16a34a',
            'medium': '#d97706', 
            'high': '#dc2626',
            'critical': '#991b1b'
          };
          const riskTexts = {
            'low': '–ù–∏–∑–∫–∏–π',
            'medium': '–°—Ä–µ–¥–Ω–∏–π',
            'high': '–í—ã—Å–æ–∫–∏–π', 
            'critical': '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π'
          };
          
          html += `
            <div style="margin-bottom: 20px;">
              <div style="font-weight: 600; margin-bottom: 8px;">üö® –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:</div>
              <div style="color: ${riskColors[analysis.risk_level] || '#6b7280'}; font-weight: 600; font-size: 16px;">
                ${riskTexts[analysis.risk_level] || analysis.risk_level}
              </div>
            </div>
          `;
        }

        // –°–∞–π—Ç—ã –¥–ª—è —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª–µ–π
        if (analysis.security_recommendations?.password_change_sites?.length > 0) {
          html += `
            <div style="margin-bottom: 20px;">
              <div style="font-weight: 600; margin-bottom: 8px;">üîê –°–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –Ω–∞ —Å–∞–π—Ç–∞—Ö:</div>
              <ul style="list-style: none; padding-left: 0;">
          `;
          analysis.security_recommendations.password_change_sites.forEach(site => {
            html += `<li style="margin-bottom: 4px; color: #dc2626;">‚Ä¢ ${site}</li>`;
          });
          html += '</ul></div>';
        }

        // –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞
        if (analysis.summary) {
          html += `
            <div style="margin-bottom: 20px;">
              <div style="font-weight: 600; margin-bottom: 8px;">üìã –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞:</div>
              <div style="color: #374151; line-height: 1.5;">${analysis.summary}</div>
            </div>
          `;
        }

        // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
        if (analysis.security_recommendations?.immediate_actions?.length > 0) {
          html += `
            <div>
              <div style="font-weight: 600; margin-bottom: 8px;">‚ö° –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:</div>
              <ul style="list-style: none; padding-left: 0;">
          `;
          analysis.security_recommendations.immediate_actions.forEach(action => {
            html += `<li style="margin-bottom: 4px; color: #059669;">‚Ä¢ ${action}</li>`;
          });
          html += '</ul></div>';
        }
      } else {
        // Fallback –¥–ª—è –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
        html += `
          <div style="color: #dc2626; font-weight: 600;">
            ‚ùå –û—à–∏–±–∫–∞: –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∞–Ω–∞–ª–∏–∑–∞
          </div>
          <pre style="background: #f3f4f6; padding: 10px; border-radius: 4px; margin-top: 10px; overflow-x: auto;">
            ${JSON.stringify(analysis, null, 2)}
          </pre>
        `;
      }

      html += '</div>';
      container.innerHTML = html;
      
      console.log('‚úÖ HTML content set!');
      console.log('üìè HTML length:', html.length);
      console.log('üëÅÔ∏è Container visibility:', container.style.display);
      console.log('üé® Final HTML preview:', html.substring(0, 300) + '...');
    }

    // –§—É–Ω–∫—Ü–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    function displayStandardLeakResults(sourceResults, aiSummary) {
      results.innerHTML = '';
      
      sourceResults.forEach((result, index) => {
        const sourceName = result.name || `–ò—Å—Ç–æ—á–Ω–∏–∫ ${index + 1}`;
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        let status = 'success'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–µ–ª–µ–Ω—ã–π (–Ω–µ—Ç —É—Ç–µ—á–µ–∫)
        
        if (result.error) {
          status = 'warning'; // –ñ–µ–ª—Ç—ã–π (–æ—à–∏–±–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞)
        } else if (result.ok && result.items) {
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
          const hasData = window.checkIfSourceHasLeakData(result, sourceName);
          if (hasData) {
            status = 'danger'; // –ö—Ä–∞—Å–Ω—ã–π (–Ω–∞–π–¥–µ–Ω—ã —É—Ç–µ—á–∫–∏)
          }
        }
        
        let displayData = result.items || result.error;
        
        // –ï—Å–ª–∏ –µ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç AI, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö
        if (aiSummary && result.ok && result.items) {
          displayData = window.formatAIDataForLeakSource(result.items, sourceName, aiSummary);
        }
        
        const item = createResultItem(sourceName, status, displayData, false, sourceName);
        results.appendChild(item);
      });
    }

    window.checkIfSourceHasLeakData = function(result, sourceName) {
      if (!result.ok || !result.items) {
        console.log(`‚ùå ${sourceName}: result.ok=${result.ok}, result.items=`, result.items);
        return false;
      }
      
      // –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
      console.log(`üîç Checking ${sourceName}:`, { 
        ok: result.ok, 
        itemsType: typeof result.items, 
        itemsKeys: typeof result.items === 'object' ? Object.keys(result.items) : 'N/A',
        itemsLength: Array.isArray(result.items) ? result.items.length : 'N/A'
      });
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö
      switch (sourceName) {
        case 'ITP':
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç (–º–∞—Å—Å–∏–≤ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π)
          if (Array.isArray(result.items) && result.items.length > 0) {
            console.log(`üéØ ITP has normalized data: ${result.items.length} records`);
            return true;
          }
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç (–æ–±—ä–µ–∫—Ç —Å –≥—Ä—É–ø–ø–∞–º–∏)
          const hasITPData = result.items && typeof result.items === 'object' && Object.keys(result.items).length > 0;
          console.log(`üéØ ITP has data: ${hasITPData}`, result.items);
          return hasITPData;
        case 'Dyxless':
          return Array.isArray(result.items) && result.items.length > 0;
        case 'LeakOsint':
          return Array.isArray(result.items) && result.items.length > 0;
        case 'Usersbox':
          return Array.isArray(result.items) && result.items.length > 0;
        case 'Vektor':
          return result.items && (Array.isArray(result.items) ? result.items.length > 0 : Object.keys(result.items).length > 0);
        default:
          return false;
      }
    };

    // ===== –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–Ø –î–ê–ù–ù–´–• –ò–ò =====
    window.formatAIDataForLeakSource = function(originalData, sourceName, aiSummary) {
      const formattedData = {};
      
      // –ï—Å–ª–∏ –µ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –ò–ò –¥–∞–Ω–Ω—ã–µ –¥–ª—è —ç—Ç–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö
      if (aiSummary && aiSummary.sources && aiSummary.sources[sourceName]) {
        const sourceInfo = aiSummary.sources[sourceName];
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
        if (sourceInfo.foundCount) {
          formattedData['üìä –ù–∞–π–¥–µ–Ω–æ –∑–∞–ø–∏—Å–µ–π'] = sourceInfo.foundCount;
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        if (sourceInfo.databases && sourceInfo.databases.length > 0) {
          formattedData['üóÑÔ∏è –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö'] = sourceInfo.databases.join(', ');
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –æ—Ç –ò–ò
        if (sourceInfo.records && Array.isArray(sourceInfo.records)) {
          sourceInfo.records.forEach((record, index) => {
            if (record && typeof record === 'object') {
              const recordInfo = [];
              
              // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∫–∞–∂–¥—É—é –∑–∞–ø–∏—Å—å
              if (record.email) recordInfo.push(`üìß ${record.email}`);
              if (record.phone) recordInfo.push(`üìû ${record.phone}`);
              if (record.name) recordInfo.push(`üë§ ${record.name}`);
              if (record.username) recordInfo.push(`üîë ${record.username}`);
              if (record.password) recordInfo.push(`üîê ${record.password.substring(0, 8)}...`);
              if (record.database) recordInfo.push(`üóÑÔ∏è ${record.database}`);
              if (record.source) recordInfo.push(`üîó ${record.source}`);
              if (record.date) recordInfo.push(`üìÖ ${record.date}`);
              
              if (recordInfo.length > 0) {
                formattedData[`üìÑ –ó–∞–ø–∏—Å—å ${index + 1}`] = recordInfo.join(' | ');
              }
            } else if (typeof record === 'string') {
              formattedData[`üìÑ –ó–∞–ø–∏—Å—å ${index + 1}`] = record;
            }
          });
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–º–µ—Ç–∫–∏ –ò–ò
        if (sourceInfo.notes) {
          formattedData['üìù –ê–Ω–∞–ª–∏–∑ –ò–ò'] = sourceInfo.notes;
        }
        
        // –ï—Å–ª–∏ –µ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Ö
        if (Object.keys(formattedData).length > 1) { // –±–æ–ª—å—à–µ 1 –ø–æ—Ç–æ–º—É —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ —Å—á–µ—Ç—á–∏–∫
          return formattedData;
        }
      }
      
      // –ï—Å–ª–∏ –Ω–µ—Ç –ò–ò –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
      if (originalData && typeof originalData === 'object') {
        switch (sourceName) {
          case 'ITP':
            formatITPData(originalData, formattedData);
            break;
          case 'Dyxless':
            formatDyxlessData(originalData, formattedData);
            break;
          case 'LeakOsint':
            formatLeakOsintData(originalData, formattedData);
            break;
          case 'Usersbox':
            formatUsersboxData(originalData, formattedData);
            break;
          case 'Vektor':
            formatVektorData(originalData, formattedData);
            break;
          default:
            Object.assign(formattedData, originalData);
        }
      }
      
      return Object.keys(formattedData).length > 0 ? formattedData : originalData;
    };

    function formatITPData(data, formattedData) {
      if (!data || typeof data !== 'object') return;
      
      // –ï—Å–ª–∏ data —ç—Ç–æ –º–∞—Å—Å–∏–≤ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
      if (Array.isArray(data)) {
        formattedData['üìä –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è'] = `–ù–∞–π–¥–µ–Ω–æ ${data.length} –∑–∞–ø–∏—Å–µ–π –≤ –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö`;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–∂–¥—É—é –∑–∞–ø–∏—Å—å –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ
        data.forEach((record, index) => {
          if (record && typeof record === 'object') {
            const userName = record.name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
            const dbName = record.dbName || record.source_database || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –ë–î';
            
            // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞–ø–∏—Å–∏
            const recordTitle = `üìÑ –ó–∞–ø–∏—Å—å ${index + 1}: ${userName}`;
            let recordContent = [];
            
            // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            recordContent.push('üîπ –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:');
            if (record.dataProvider || record._original?.data_provider) {
              recordContent.push(`  ÔøΩ –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö: ${record.dataProvider || record._original.data_provider}`);
            }
            recordContent.push(`  üíæ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: ${dbName}`);
            
            if (record.name) recordContent.push(`  ÔøΩ –ò–º—è: ${record.name}`);
            if (record.email) recordContent.push(`  üìß Email: ${record.email}`);
            if (record.phone) recordContent.push(`  üì± –¢–µ–ª–µ—Ñ–æ–Ω: ${record.phone}`);
            if (record.address) recordContent.push(`  üè† –ê–¥—Ä–µ—Å: ${record.address}`);
            if (record.birthDate) recordContent.push(`  üéÇ –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: ${record.birthDate}`);
            if (record.gender) recordContent.push(`  ‚ößÔ∏è –ü–æ–ª: ${record.gender}`);
            if (record.isVip !== undefined) {
              recordContent.push(`  ‚≠ê VIP —Å—Ç–∞—Ç—É—Å: ${record.isVip ? '–î–∞' : '–ù–µ—Ç'}`);
            }
            
            // –£—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
            const original = record._original;
            if (original?.accounts && Array.isArray(original.accounts) && original.accounts.length > 0) {
              recordContent.push('');
              recordContent.push('üîê –£—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏:');
              original.accounts.forEach(account => {
                if (account.title) recordContent.push(`  üè∑Ô∏è –°–µ—Ä–≤–∏—Å: ${account.title}`);
                if (account.login) recordContent.push(`  üë®‚Äçüíª –õ–æ–≥–∏–Ω: ${account.login}`);
                if (account.password) recordContent.push(`  üîë –ü–∞—Ä–æ–ª—å: ${account.password}`);
                if (account.password_hash) recordContent.push(`  üîê –•–µ—à –ø–∞—Ä–æ–ª—è: ${account.password_hash}`);
                if (account.id) recordContent.push(`  üÜî ID: ${account.id}`);
                if (account.url) recordContent.push(`  üåê URL: ${account.url}`);
              });
            }
            
            // –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            if (original?.financials && Array.isArray(original.financials) && original.financials.length > 0) {
              recordContent.push('');
              recordContent.push('üí≥ –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:');
              original.financials.forEach(financial => {
                if (financial.title) recordContent.push(`  üè¶ –ë–∞–Ω–∫: ${financial.title}`);
                if (financial.card_number) recordContent.push(`  üí≥ –ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã: ${financial.card_number}`);
                if (financial.date && financial.date !== 'undefined') recordContent.push(`  üìÖ –î–∞—Ç–∞: ${financial.date}`);
              });
            }
            
            // –î–æ–∫—É–º–µ–Ω—Ç—ã
            if (original?.documents && Array.isArray(original.documents) && original.documents.length > 0) {
              recordContent.push('');
              recordContent.push('üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã:');
              original.documents.forEach(doc => {
                if (doc.type !== undefined) {
                  const docType = doc.type === 0 ? '–ü–∞—Å–ø–æ—Ä—Ç' : doc.type === 1 ? '–°–ù–ò–õ–°' : `–¢–∏–ø ${doc.type}`;
                  recordContent.push(`  üìã –¢–∏–ø: ${docType}`);
                }
                if (doc.serial) recordContent.push(`  üî¢ –ù–æ–º–µ—Ä: ${doc.serial}`);
                if (doc.authority) recordContent.push(`  üèõÔ∏è –û—Ä–≥–∞–Ω –≤—ã–¥–∞—á–∏: ${doc.authority}`);
                if (doc.country) recordContent.push(`  üåç –°—Ç—Ä–∞–Ω–∞: ${doc.country}`);
                if (doc.date_issue) recordContent.push(`  ÔøΩ –î–∞—Ç–∞ –≤—ã–¥–∞—á–∏: ${doc.date_issue}`);
              });
            }
            
            // –¢–µ–ª–µ–≥—Ä–∞–º –∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏
            if (record.telegramId) {
              recordContent.push('');
              recordContent.push('üì± –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏:');
              recordContent.push(`  üì± Telegram ID: ${record.telegramId}`);
            }
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞
            if (record.additionalNames && Array.isArray(record.additionalNames)) {
              recordContent.push('');
              recordContent.push('üë• –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞:');
              record.additionalNames.forEach(name => {
                recordContent.push(`  üìù ${name}`);
              });
            }
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            const additionalInfo = [];
            if (record.actuality) additionalInfo.push(`üìÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö: ${record.actuality}`);
            if (record.createdDate) additionalInfo.push(`ÔøΩ –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: ${record.createdDate}`);
            if (record.phoneCarrier) additionalInfo.push(`üì∂ –û–ø–µ—Ä–∞—Ç–æ—Ä —Å–≤—è–∑–∏: ${record.phoneCarrier}`);
            if (record.phoneRegion) additionalInfo.push(`üåç –†–µ–≥–∏–æ–Ω: ${record.phoneRegion}`);
            if (record.crmId) additionalInfo.push(`üî¢ CRM ID: ${record.crmId}`);
            if (record.senderInn) additionalInfo.push(`üè¢ –ò–ù–ù –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è: ${record.senderInn}`);
            if (record.senderName) additionalInfo.push(`üëî –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å: ${record.senderName}`);
            if (record.postalCode) additionalInfo.push(`üìÆ –ò–Ω–¥–µ–∫—Å: ${record.postalCode}`);
            if (record.notes) additionalInfo.push(`ÔøΩ –ó–∞–º–µ—Ç–∫–∏: ${record.notes.substring(0, 100)}...`);
            
            if (additionalInfo.length > 0) {
              recordContent.push('');
              recordContent.push('üîπ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:');
              additionalInfo.forEach(info => recordContent.push(`  ${info}`));
            }
            
            formattedData[recordTitle] = recordContent.join('\n');
          }
        });
        
        return;
      }
      
      // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ä–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ (–µ—Å–ª–∏ data —ç—Ç–æ –æ–±—ä–µ–∫—Ç —Å –≥—Ä—É–ø–ø–∞–º–∏)
      for (const [groupName, groupData] of Object.entries(data)) {
        if (groupData && groupData.data && Array.isArray(groupData.data)) {
          formattedData[`üìÅ ${groupName}`] = `${groupData.data.length} –∑–∞–ø–∏—Å–µ–π`;
          
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π
          groupData.data.slice(0, 3).forEach((record, index) => {
            if (record && typeof record === 'object') {
              const recordInfo = [];
              if (record.phone) recordInfo.push(`üìû ${record.phone}`);
              if (record.email) recordInfo.push(`üìß ${record.email}`);
              if (record.name) recordInfo.push(`üë§ ${record.name}`);
              if (record.address) recordInfo.push(`üè† ${record.address}`);
              
              if (recordInfo.length > 0) {
                formattedData[`  ‚îî –ó–∞–ø–∏—Å—å ${index + 1}`] = recordInfo.join(', ');
              }
            }
          });
          
          if (groupData.data.length > 3) {
            formattedData[`  ‚îî ...`] = `–∏ –µ—â–µ ${groupData.data.length - 3} –∑–∞–ø–∏—Å–µ–π`;
          }
        }
      }
    }

    function formatDyxlessData(data, formattedData) {
      if (!Array.isArray(data)) return;
      
      formattedData['üìä –í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π'] = data.length;
      
      // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö
      const databases = {};
      data.forEach(record => {
        if (record && record.database) {
          if (!databases[record.database]) {
            databases[record.database] = [];
          }
          databases[record.database].push(record);
        }
      });
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –±–∞–∑–∞–º
      for (const [dbName, records] of Object.entries(databases)) {
        formattedData[`üóÑÔ∏è –ë–∞–∑–∞: ${dbName}`] = `${records.length} –∑–∞–ø–∏—Å–µ–π`;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ –∑–∞–ø–∏—Å–∏
        records.slice(0, 2).forEach((record, index) => {
          const recordInfo = [];
          if (record.email) recordInfo.push(`üìß ${record.email}`);
          if (record.phone) recordInfo.push(`üìû ${record.phone}`);
          if (record.name) recordInfo.push(`üë§ ${record.name}`);
          if (record.password) recordInfo.push(`üîë ${record.password.substring(0, 10)}...`);
          
          if (recordInfo.length > 0) {
            formattedData[`  ‚îî ${index + 1}`] = recordInfo.join(', ');
          }
        });
      }
    }

    function formatLeakOsintData(data, formattedData) {
      if (!Array.isArray(data)) return;
      
      formattedData['üìä –ù–∞–π–¥–µ–Ω–æ –±–∞–∑'] = data.length;
      
      data.forEach((leak, index) => {
        if (leak && leak.db) {
          formattedData[`üóÑÔ∏è –ë–∞–∑–∞: ${leak.db}`] = leak.info || '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞–∑–µ';
          
          if (leak.data && Array.isArray(leak.data)) {
            formattedData[`  ‚îî –ó–∞–ø–∏—Å–µ–π –≤ –±–∞–∑–µ`] = leak.data.length;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ –∑–∞–ø–∏—Å–∏
            leak.data.slice(0, 2).forEach((record, recordIndex) => {
              if (typeof record === 'string') {
                formattedData[`  ‚îî ${recordIndex + 1}`] = record;
              } else if (typeof record === 'object') {
                const recordInfo = [];
                Object.entries(record).forEach(([key, value]) => {
                  if (value && typeof value === 'string') {
                    recordInfo.push(`${key}: ${value}`);
                  }
                });
                if (recordInfo.length > 0) {
                  formattedData[`  ‚îî ${recordIndex + 1}`] = recordInfo.join(', ');
                }
              }
            });
          }
        }
      });
    }

    function formatUsersboxData(data, formattedData) {
      if (!Array.isArray(data)) {
        console.log('‚ö†Ô∏è Usersbox data is not an array:', data);
        return;
      }
      
      console.log('üìä Processing Usersbox data:', data.length, 'sources');
      
      data.forEach((sourceData, sourceIndex) => {
        if (!sourceData || typeof sourceData !== 'object') {
          console.log(`‚ö†Ô∏è Invalid source data at index ${sourceIndex}`);
          return;
        }

        const sourceName = sourceData.source || `Source ${sourceIndex + 1}`;
        const items = sourceData.items || [];
        const count = sourceData.count || items.length;
        const hitsCount = sourceData.hitsCount || count;

        console.log(`ÔøΩ Processing source "${sourceName}" with ${items.length} items`);

        // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
        const sourceHeader = `${sourceName}`;
        formattedData[sourceHeader] = `–ù–∞–π–¥–µ–Ω–æ: ${hitsCount} –∑–∞–ø–∏—Å–µ–π, –ø–æ–∫–∞–∑–∞–Ω–æ: ${items.length}`;

        // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—É—é –∑–∞–ø–∏—Å—å
        items.forEach((record, recordIndex) => {
          if (!record || typeof record !== 'object') return;

          // ID –∑–∞–ø–∏—Å–∏
          if (record._id) {
            const idKey = recordIndex === 0 ? '_id:' : `_id: (${recordIndex + 1})`;
            if (typeof record._id === 'string') {
              formattedData[idKey] = `{"$oid":"${record._id}"}`;
            } else {
              formattedData[idKey] = JSON.stringify(record._id);
            }
          }

          // –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
          if (record.fullName) {
            formattedData['full_name:'] = record.fullName;
          }
          if (record.firstName) {
            formattedData['first_name:'] = record.firstName;
          }
          if (record.lastName) {
            formattedData['last_name:'] = record.lastName;
          }
          if (record.name) {
            formattedData['name:'] = record.name;
          }
          if (record.contactPerson) {
            formattedData['contact_person:'] = record.contactPerson;
          }
          if (record.surName) {
            formattedData['sur_name:'] = record.surName;
          }
          if (record.patronymic) {
            formattedData['patronymic:'] = record.patronymic;
          }

          // –î–∞—Ç—ã
          if (record.birthDate) {
            formattedData['birth_date:'] = record.birthDate;
          }
          if (record.birthday) {
            formattedData['birthday:'] = record.birthday;
          }
          if (record.createdAt) {
            formattedData['created_at:'] = record.createdAt;
          }
          if (record.deliveredAt) {
            formattedData['delivered_at:'] = record.deliveredAt;
          }
          if (record.date) {
            formattedData['date:'] = record.date;
          }
          if (record.deliveryDate) {
            formattedData['delivery_date:'] = record.deliveryDate;
          }
          if (record.datRecognize) {
            formattedData['dat_recognize:'] = record.datRecognize;
          }
          if (record.datProcess) {
            formattedData['dat_process:'] = record.datProcess;
          }
          if (record.updated) {
            formattedData['updated:'] = record.updated;
          }
          if (record.moderationTime) {
            formattedData['moderation_time:'] = record.moderationTime;
          }

          // –ö–æ–Ω—Ç–∞–∫—Ç—ã
          if (record.phone && record.phone.length > 0) {
            if (record.phone.length === 1) {
              formattedData['phone:'] = record.phone[0];
            } else {
              formattedData['phones:'] = JSON.stringify(record.phone);
            }
          }
          if (record.email && record.email.length > 0) {
            if (record.email.length === 1) {
              formattedData['email:'] = record.email[0];
            } else {
              formattedData['emails:'] = JSON.stringify(record.email);
            }
          }

          // –ê–¥—Ä–µ—Å–∞
          if (record.addresses) {
            formattedData['addresses:'] = JSON.stringify(record.addresses);
          }
          if (record.address) {
            formattedData['address:'] = record.address;
          }
          if (record.addressFact) {
            formattedData['address_fact:'] = record.addressFact;
          }
          if (record.addressReal) {
            formattedData['address_real:'] = record.addressReal;
          }

          // –ì–µ–æ–≥—Ä–∞—Ñ–∏—è
          if (record.area) formattedData['area:'] = record.area;
          if (record.city) formattedData['city:'] = record.city;
          if (record.country) formattedData['country:'] = record.country;
          if (record.street) formattedData['street:'] = record.street;
          if (record.house) formattedData['house:'] = record.house;
          if (record.postalCode) formattedData['postal_code:'] = record.postalCode;
          if (record.timezone) formattedData['timezone:'] = record.timezone;
          if (record.fiasId) formattedData['fias_id:'] = record.fiasId;
          if (record.fiasAddr) formattedData['fias_addr:'] = record.fiasAddr;
          if (record.longitude) formattedData['longitude:'] = record.longitude;
          if (record.latitude) formattedData['latitude:'] = record.latitude;
          if (record.floor) formattedData['floor:'] = record.floor;
          if (record.intercom) formattedData['intercom:'] = record.intercom;
          if (record.title) formattedData['title:'] = record.title;

          // –¢–æ—á–∫–∞ –≤—ã–¥–∞—á–∏
          if (record.pickupPoint) {
            formattedData['pickup_point:'] = record.pickupPoint;
          }

          // –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
          if (record.accounts) {
            formattedData['accounts:'] = JSON.stringify(record.accounts);
          }
          if (record.accountNumber) {
            formattedData['account_number:'] = record.accountNumber;
          }
          if (record.cards) {
            formattedData['cards:'] = JSON.stringify(record.cards);
          }
          if (record.inn) {
            formattedData['inn:'] = record.inn;
          }
          if (record.citizenship) {
            formattedData['citizenship:'] = record.citizenship;
          }
          if (record.gender) {
            formattedData['gender:'] = record.gender;
          }

          // –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
          if (record.shippingCost) {
            formattedData['shipping_cost:'] = record.shippingCost;
          }
          if (record.price) {
            formattedData['price:'] = record.price;
          }
          if (record.amount) {
            formattedData['amount:'] = record.amount;
          }
          if (record.currency) {
            formattedData['currency:'] = record.currency;
          }

          // –ó–∞–∫–∞–∑—ã –∏ –ø—Ä–æ–¥—É–∫—Ç—ã
          if (record.products) {
            formattedData['products:'] = JSON.stringify(record.products);
          }
          if (record.firstOrder) {
            formattedData['first_order:'] = record.firstOrder;
          }
          if (record.platform) {
            formattedData['platform:'] = record.platform;
          }
          if (record.paid) {
            formattedData['paid:'] = record.paid;
          }
          if (record.deliveryCityId) {
            formattedData['delivery_city_id:'] = record.deliveryCityId;
          }
          if (record.status) {
            formattedData['status:'] = record.status;
          }

          // –°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
          if (record.wantReceiveInfo) {
            formattedData['want_receive_info:'] = record.wantReceiveInfo;
          }
          if (record.langCode) {
            formattedData['lang_code:'] = record.langCode;
          }
          if (record.cashier) {
            formattedData['cashier:'] = record.cashier;
          }
          if (record.hasSign) {
            formattedData['has_sign:'] = record.hasSign;
          }

          // –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
          if (record.recovery) {
            formattedData['recovery:'] = record.recovery;
          }
          if (record.token) {
            formattedData['token:'] = record.token;
          }
          if (record.stage) {
            formattedData['stage:'] = record.stage;
          }
          if (record.time) {
            formattedData['time:'] = record.time;
          }
          if (record.userInfo) {
            formattedData['user_info:'] = record.userInfo;
          }
          if (record.geo) {
            formattedData['geo:'] = record.geo;
          }
          if (record.work) {
            formattedData['work:'] = record.work;
          }
          if (record.place) {
            formattedData['place:'] = record.place;
          }
          if (record.industry) {
            formattedData['industry:'] = record.industry;
          }
          if (record.position) {
            formattedData['position:'] = record.position;
          }
          if (record.ogrn) {
            formattedData['ogrn:'] = record.ogrn;
          }
          if (record.year) {
            formattedData['year:'] = record.year;
          }
          if (record.month) {
            formattedData['month:'] = record.month;
          }
          if (record.day) {
            formattedData['day:'] = record.day;
          }
          if (record.passport) {
            formattedData['passport:'] = record.passport;
          }
          if (record.docs) {
            formattedData['docs:'] = record.docs;
          }
          if (record.snils) {
            formattedData['snils:'] = record.snils;
          }
          if (record.snilsDop) {
            formattedData['snils_dop:'] = record.snilsDop;
          }
          if (record.idDocName) {
            formattedData['idDocName:'] = record.idDocName;
          }
          if (record.idDoc) {
            formattedData['idDoc:'] = record.idDoc;
          }
          if (record.images) {
            formattedData['images:'] = record.images;
          }
          if (record.login) {
            formattedData['login:'] = record.login;
          }
          if (record.moderation) {
            formattedData['moderation:'] = record.moderation;
          }
          if (record.isModerated) {
            formattedData['is_moderated:'] = record.isModerated;
          }

          // Yandex Eda –¥–∞–Ω–Ω—ã–µ
          if (record.userId) {
            formattedData['user_id:'] = record.userId;
          }
          if (record.yandexUid) {
            formattedData['yandex_uid:'] = record.yandexUid;
          }
          if (record.app) {
            formattedData['app:'] = record.app;
          }
          if (record.userAgent) {
            formattedData['user_agent:'] = record.userAgent;
          }
          if (record.payment) {
            formattedData['payment:'] = record.payment;
          }
          if (record.service) {
            formattedData['service:'] = record.service;
          }

          // –ü–∞—Ä–æ–ª–∏ –∏ –¥—Ä—É–≥–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
          if (record.password) {
            formattedData['password:'] = record.password;
          }

          // –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
          if (record.comment) {
            formattedData['comment:'] = record.comment;
          }

          // Score
          if (record._score) {
            formattedData['_score:'] = record._score;
          }
        });
      });
    }

    function formatVektorData(data, formattedData) {
      if (Array.isArray(data)) {
        formattedData['üìä –í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π'] = data.length;
        
        data.slice(0, 5).forEach((record, index) => {
          if (typeof record === 'string') {
            formattedData[`üìÑ ${index + 1}`] = record;
          } else if (typeof record === 'object') {
            const recordInfo = [];
            Object.entries(record).forEach(([key, value]) => {
              if (value) recordInfo.push(`${key}: ${value}`);
            });
            if (recordInfo.length > 0) {
              formattedData[`üìÑ ${index + 1}`] = recordInfo.join(', ');
            }
          }
        });
      } else if (typeof data === 'object') {
        Object.entries(data).forEach(([key, value]) => {
          if (value) {
            formattedData[key] = Array.isArray(value) ? value.join(', ') : value;
          }
        });
      }
    }

    function formatLeakOsintData(data, formattedData) {
      if (!Array.isArray(data) || data.length === 0) {
        formattedData['üìÑ –†–µ–∑—É–ª—å—Ç–∞—Ç'] = '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è';
        return;
      }
      
      console.log('üîß formatLeakOsintData processing records:', data.length);
      
      // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
      formattedData['üìä –í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π'] = data.length;
      
      // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—É—é –∑–∞–ø–∏—Å—å
      data.forEach((record, index) => {
        if (record && typeof record === 'object') {
          const recordTitle = `üìÑ –ó–∞–ø–∏—Å—å ${index + 1}`;
          let recordInfo = '';
          
          // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
          if (record.database) {
            recordInfo += `–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: ${record.database}\n`;
          }
          if (record.databaseInfo) {
            recordInfo += `–û–ø–∏—Å–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: ${record.databaseInfo}\n\n`;
          }
          
          // –ï—Å–ª–∏ –µ—Å—Ç—å –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏—Ö
          if (record.records && Array.isArray(record.records)) {
            recordInfo += `–î–∞–Ω–Ω—ã–µ:\n`;
            
            record.records.forEach((dataRecord, dataIndex) => {
              if (dataIndex > 0) recordInfo += '\n';
              
              // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
              if (dataRecord.fullName) recordInfo += `–§–ò–û: ${dataRecord.fullName}\n`;
              if (dataRecord.firstName) recordInfo += `–ò–º—è: ${dataRecord.firstName}\n`;
              if (dataRecord.lastName) recordInfo += `–§–∞–º–∏–ª–∏—è: ${dataRecord.lastName}\n`;
              if (dataRecord.middleName) recordInfo += `–û—Ç—á–µ—Å—Ç–≤–æ: ${dataRecord.middleName}\n`;
              if (dataRecord.nickName) recordInfo += `–ù–∏–∫–Ω–µ–π–º: ${dataRecord.nickName}\n`;
              
              // –ö–æ–Ω—Ç–∞–∫—Ç—ã
              if (dataRecord.phone) recordInfo += `–¢–µ–ª–µ—Ñ–æ–Ω: ${dataRecord.phone}\n`;
              if (dataRecord.email) recordInfo += `Email: ${dataRecord.email}\n`;
              
              // –ê–¥—Ä–µ—Å
              if (dataRecord.address) recordInfo += `–ê–¥—Ä–µ—Å: ${dataRecord.address}\n`;
              if (dataRecord.pointAddress) recordInfo += `–ê–¥—Ä–µ—Å –ø—É–Ω–∫—Ç–∞ –≤—ã–¥–∞—á–∏: ${dataRecord.pointAddress}\n`;
              if (dataRecord.region) recordInfo += `–†–µ–≥–∏–æ–Ω: ${dataRecord.region}\n`;
              if (dataRecord.city) recordInfo += `–ì–æ—Ä–æ–¥: ${dataRecord.city}\n`;
              if (dataRecord.rusStreet) recordInfo += `–£–ª–∏—Ü–∞: ${dataRecord.rusStreet}\n`;
              if (dataRecord.house) recordInfo += `–î–æ–º: ${dataRecord.house}\n`;
              if (dataRecord.postCode) recordInfo += `–ü–æ—á—Ç–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å: ${dataRecord.postCode}\n`;
              
              // –î–æ–∫—É–º–µ–Ω—Ç—ã
              if (dataRecord.passport) recordInfo += `–ü–∞—Å–ø–æ—Ä—Ç: ${dataRecord.passport}\n`;
              if (dataRecord.snils) recordInfo += `–°–ù–ò–õ–°: ${dataRecord.snils}\n`;
              if (dataRecord.inn) recordInfo += `–ò–ù–ù: ${dataRecord.inn}\n`;
              
              // –õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
              if (dataRecord.birthDate) recordInfo += `–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: ${dataRecord.birthDate}\n`;
              if (dataRecord.gender) recordInfo += `–ü–æ–ª: ${dataRecord.gender}\n`;
              if (dataRecord.citizenship) recordInfo += `–ì—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ: ${dataRecord.citizenship}\n`;
              
              // –§–∏–Ω–∞–Ω—Å—ã
              if (dataRecord.amount) recordInfo += `–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞: ${dataRecord.amount}\n`;
              if (dataRecord.price) recordInfo += `–¶–µ–Ω–∞: ${dataRecord.price}\n`;
              if (dataRecord.balance) recordInfo += `–ë–∞–ª–∞–Ω—Å: ${dataRecord.balance}\n`;
              if (dataRecord.hasCards) recordInfo += `–ù–∞–ª–∏—á–∏–µ –∫–∞—Ä—Ç: ${dataRecord.hasCards}\n`;
              
              // –¢–æ–≤–∞—Ä—ã –∏ –∑–∞–∫–∞–∑—ã
              if (dataRecord.product) recordInfo += `–¢–æ–≤–∞—Ä: ${dataRecord.product}\n`;
              if (dataRecord.product2) recordInfo += `–¢–æ–≤–∞—Ä 2: ${dataRecord.product2}\n`;
              if (dataRecord.product3) recordInfo += `–¢–æ–≤–∞—Ä 3: ${dataRecord.product3}\n`;
              
              // –ö–æ–º–ø–∞–Ω–∏—è
              if (dataRecord.company) recordInfo += `–ö–æ–º–ø–∞–Ω–∏—è: ${dataRecord.company}\n`;
              if (dataRecord.nameCompany) recordInfo += `–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏: ${dataRecord.nameCompany}\n`;
              
              // –î–∞—Ç—ã
              if (dataRecord.date) recordInfo += `–î–∞—Ç–∞: ${dataRecord.date}\n`;
              if (dataRecord.dateUnix) recordInfo += `–î–∞—Ç–∞: ${dataRecord.dateUnix}\n`;
              if (dataRecord.deliveryDate) recordInfo += `–î–∞—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏: ${dataRecord.deliveryDate}\n`;
              if (dataRecord.regDate) recordInfo += `–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ${dataRecord.regDate}\n`;
              if (dataRecord.regDateUnix) recordInfo += `–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ${dataRecord.regDateUnix}\n`;
              if (dataRecord.lastActive) recordInfo += `–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: ${dataRecord.lastActive}\n`;
              
              // –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
              if (dataRecord.os) recordInfo += `–û–°: ${dataRecord.os}\n`;
              if (dataRecord.deliveryType) recordInfo += `–¢–∏–ø –¥–æ—Å—Ç–∞–≤–∫–∏: ${dataRecord.deliveryType}\n`;
              if (dataRecord.paymentType) recordInfo += `–¢–∏–ø –æ–ø–ª–∞—Ç—ã: ${dataRecord.paymentType}\n`;
              if (dataRecord.status) recordInfo += `–°—Ç–∞—Ç—É—Å: ${dataRecord.status}\n`;
              if (dataRecord.clientType) recordInfo += `–¢–∏–ø –∫–ª–∏–µ–Ω—Ç–∞: ${dataRecord.clientType}\n`;
              
              // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
              if (dataRecord.description) recordInfo += `–û–ø–∏—Å–∞–Ω–∏–µ: ${dataRecord.description}\n`;
              if (dataRecord.comment) recordInfo += `–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ${dataRecord.comment}\n`;
              if (dataRecord.text) recordInfo += `–¢–µ–∫—Å—Ç: ${dataRecord.text}\n`;
              if (dataRecord.tags) recordInfo += `–¢–µ–≥–∏: ${dataRecord.tags}\n`;
              if (dataRecord.vkId) recordInfo += `VK ID: ${dataRecord.vkId}\n`;
              if (dataRecord.password) recordInfo += `–ü–∞—Ä–æ–ª—å: ${dataRecord.password}\n`;
            });
          }
          
          // –£–±–∏—Ä–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–æ–∫–∏ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å
          if (recordInfo) {
            formattedData[recordTitle] = recordInfo.trim();
          }
        }
      });
      
      console.log('‚úÖ formatLeakOsintData: Processed', data.length, 'records');
    }

    function displayFinanceData(bodyId, financeData) {
      const bodyEl = document.getElementById(bodyId);
      if (!bodyEl || !financeData) return;
      
      console.log('üìä Displaying finance data:', financeData);
      
      let financeHtml = '<div style="margin-top: 20px; border-top: 2px solid #e5e7eb; padding-top: 16px;">';
      financeHtml += '<h4 style="color: #1f2937; font-weight: 600; margin-bottom: 12px;">üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>';
      
      // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–ø–∞–Ω–∏–∏
      if (financeData.company) {
        financeHtml += '<div style="margin-bottom: 16px;">';
        financeHtml += '<h5 style="color: #374151; font-weight: 600; margin-bottom: 8px;">–ö–æ–º–ø–∞–Ω–∏—è</h5>';
        financeHtml += formatResultData(financeData.company);
        financeHtml += '</div>';
      }
      
      // –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –≥–æ–¥–∞–º
      if (financeData.data && typeof financeData.data === 'object') {
        financeHtml += '<div style="margin-bottom: 16px;">';
        financeHtml += '<h5 style="color: #374151; font-weight: 600; margin-bottom: 8px;">–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h5>';
        
        const years = Object.keys(financeData.data).sort((a, b) => b - a); // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é
        
        if (years.length > 0) {
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –≥–æ–¥–∞
          const recentYears = years.slice(0, 3);
          
          recentYears.forEach(year => {
            const yearData = financeData.data[year];
            if (yearData && typeof yearData === 'object') {
              financeHtml += `<div style="margin-bottom: 12px; padding: 8px; background: #f9fafb; border-radius: 4px;">`;
              financeHtml += `<h6 style="color: #1f2937; font-weight: 600; margin-bottom: 8px;">üìÖ ${year} –≥–æ–¥</h6>`;
              
              // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
              const formattedYearData = formatFinancialIndicators(yearData);
              financeHtml += formatResultData(formattedYearData);
              
              financeHtml += '</div>';
            }
          });
          
          if (years.length > 3) {
            financeHtml += `<div style="color: #6b7280; font-style: italic;">–ò –µ—â–µ –¥–∞–Ω–Ω—ã–µ –∑–∞ ${years.length - 3} –ª–µ—Ç(–∞)</div>`;
          }
        } else {
          financeHtml += '<div style="color: #6b7280;">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</div>';
        }
        
        financeHtml += '</div>';
      }
      
      // –°—Å—ã–ª–∫–∏ –Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
      if (financeData['bo.nalog.ru'] && financeData['bo.nalog.ru']['–û—Ç—á–µ—Ç']) {
        const reports = financeData['bo.nalog.ru']['–û—Ç—á–µ—Ç'];
        financeHtml += '<div style="margin-bottom: 16px;">';
        financeHtml += '<h5 style="color: #374151; font-weight: 600; margin-bottom: 8px;">üìã –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –§–ù–°</h5>';
        
        Object.entries(reports).forEach(([year, url]) => {
          financeHtml += `<div style="margin-bottom: 4px;">`;
          financeHtml += `<a href="${url}" target="_blank" style="color: #2563eb; text-decoration: underline;">`;
          financeHtml += `üìÑ –û—Ç—á–µ—Ç –∑–∞ ${year} –≥–æ–¥</a>`;
          financeHtml += `</div>`;
        });
        
        financeHtml += '</div>';
      }
      
      financeHtml += '</div>';
      
      bodyEl.innerHTML += financeHtml;
    }
    
    function formatFinancialIndicators(yearData) {
      const formatted = {};
      
      // –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Å —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–æ–π –∫–æ–¥–æ–≤
      const indicators = {
        '1100': '–ò—Ç–æ–≥–æ –ø–æ —Ä–∞–∑–¥–µ–ª—É I (–≤–Ω–µ–æ–±–æ—Ä–æ—Ç–Ω—ã–µ –∞–∫—Ç–∏–≤—ã)',
        '1200': '–ò—Ç–æ–≥–æ –ø–æ —Ä–∞–∑–¥–µ–ª—É II (–æ–±–æ—Ä–æ—Ç–Ω—ã–µ –∞–∫—Ç–∏–≤—ã)', 
        '1600': '–ë–ê–õ–ê–ù–° (–∞–∫—Ç–∏–≤)',
        '1300': '–ò—Ç–æ–≥–æ –ø–æ —Ä–∞–∑–¥–µ–ª—É III (–∫–∞–ø–∏—Ç–∞–ª –∏ —Ä–µ–∑–µ—Ä–≤—ã)',
        '1400': '–ò—Ç–æ–≥–æ –ø–æ —Ä–∞–∑–¥–µ–ª—É IV (–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞)',
        '1500': '–ò—Ç–æ–≥–æ –ø–æ —Ä–∞–∑–¥–µ–ª—É V (–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞)',
        '1700': '–ë–ê–õ–ê–ù–° (–ø–∞—Å—Å–∏–≤)',
        '2110': '–í—ã—Ä—É—á–∫–∞',
        '2200': '–ü—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫) –æ—Ç –ø—Ä–æ–¥–∞–∂',
        '2300': '–ü—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫) –¥–æ –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è',
        '2400': '–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫)'
      };
      
      Object.entries(indicators).forEach(([code, description]) => {
        if (yearData[code] !== undefined && yearData[code] !== null) {
          const value = Number(yearData[code]);
          if (!isNaN(value)) {
            // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∫—Ä—É–ø–Ω—ã–µ —Å—É–º–º—ã
            formatted[description] = formatCurrency(value);
          }
        }
      });
      
      return formatted;
    }
    
    function formatCurrency(value) {
      if (Math.abs(value) >= 1000000) {
        return `${(value / 1000000).toFixed(1)} –º–ª–Ω —Ä—É–±.`;
      } else if (Math.abs(value) >= 1000) {
        return `${(value / 1000).toFixed(0)} —Ç—ã—Å. —Ä—É–±.`;
      } else {
        return `${value} —Ä—É–±.`;
      }
    }

    // –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
    function showProgress() {
      document.getElementById('progressContainer').style.display = 'block';
      resetProgress();
    }

    function hideProgress() {
      document.getElementById('progressContainer').style.display = 'none';
    }

    function resetProgress() {
      const fill = document.getElementById('progressFill');
      const percent = document.getElementById('progressPercent');
      const status = document.getElementById('progressStatus');
      
      fill.style.width = '0%';
      percent.textContent = '0%';
      status.textContent = '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...';
    }

    function updateProgress(percentage, statusText) {
      const fill = document.getElementById('progressFill');
      const percent = document.getElementById('progressPercent');
      const status = document.getElementById('progressStatus');
      
      fill.style.width = percentage + '%';
      percent.textContent = Math.round(percentage) + '%';
      status.textContent = statusText;
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    function createResultItem(title, status, data, isOpen = false, sourceName = null) {
      const item = document.createElement('div');
      item.className = `result-card ${isOpen ? 'open' : ''}`;
      
      const statusClass = status === 'success' ? 'status-clean' : 
                         status === 'danger' ? 'status-found' : 'status-error';
      const statusText = status === 'success' ? '–ß–∏—Å—Ç–æ' : 
                        status === 'danger' ? '–ù–∞–π–¥–µ–Ω–æ' : '–û—à–∏–±–∫–∞';

      // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
      let formattedData;
      if (typeof data === 'string') {
        formattedData = data;
      } else if (sourceName) {
        console.log('üéØ createResultItem: Using source-specific formatter for', sourceName);
        formattedData = formatResultDataBySource(data, sourceName);
      } else {
        console.log('üéØ createResultItem: Using default formatter (no sourceName)');
        formattedData = formatResultData(data);
      }

      item.innerHTML = `
        <div class="result-header" onclick="toggleResult(this)">
          <div class="result-title">${title}</div>
          <div class="flex items-center gap-3">
            <span class="status-badge ${statusClass}">${statusText}</span>
            <span class="caret">‚ñ∂</span>
          </div>
        </div>
        <div class="result-body">
          ${formattedData}
        </div>
      `;

      return item;
    }

    // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    function toggleResult(header) {
      const card = header.closest('.result-card');
      card.classList.toggle('open');
    }

    // –§—É–Ω–∫—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    function formatResultDataBySource(data, sourceName) {
      console.log('üéØ formatResultDataBySource called for:', sourceName, {
        dataType: typeof data,
        isArray: Array.isArray(data),
        length: Array.isArray(data) ? data.length : 'not array'
      });
      
      switch(sourceName) {
        case 'ITP':
          console.log('üîç Using ITP formatter');
          return formatITPResultData(data);
        case 'Dyxless':
          console.log('üîç Using Dyxless formatter (fallback to JSON for now)');
          return formatResultData(data);
        case 'LeakOsint':
          console.log('üîç Using LeakOsint formatter');
          return formatLeakOsintResultData(data);
        case 'Usersbox':
          console.log('üîç Using Usersbox formatter');
          return formatUsersboxResultData(data);
        case 'Vektor':
          console.log('üîç Using Vektor formatter (fallback to JSON for now)');
          return formatResultData(data);
        case 'Snusbase':
          console.log('üîç Using Snusbase formatter (fallback to JSON for now)');
          return formatResultData(data);
        default:
          console.log('üîç Using default JSON formatter for:', sourceName);
          return formatResultData(data);
      }
    }

    function formatITPResultData(data) {
      console.log('üîß formatITPResultData called with:', {
        dataType: typeof data,
        isArray: Array.isArray(data),
        length: Array.isArray(data) ? data.length : 'not array',
        keys: data && typeof data === 'object' ? Object.keys(data).slice(0, 3) : 'no keys'
      });
      
      if (!data) {
        console.log('‚ùå formatITPResultData: No data provided');
        return '<div style="color: #6b7280;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</div>';
      }
      
      const formattedData = {};
      formatITPData(data, formattedData);
      
      console.log('‚úÖ formatITPResultData: Formatted data keys:', Object.keys(formattedData));
      
      // –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è ITP –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–µ—Ä–µ–Ω–æ—Å–∞–º–∏ —Å—Ç—Ä–æ–∫
      let html = '<div style="font-family: monospace; line-height: 1.6; white-space: pre-line;">';
      
      for (const [key, value] of Object.entries(formattedData)) {
        if (value !== null && value !== undefined && value !== '') {
          const formattedValue = Array.isArray(value) ? value.join('\n') : String(value);
          html += `<div style="margin-bottom: 20px;"><strong>${key}</strong>\n${formattedValue}</div>`;
        }
      }
      
      html += '</div>';
      
      console.log('üìã formatITPResultData: Final result length:', html ? html.length : 'null');
      
      return html;
    }

    function formatLeakOsintResultData(data) {
      console.log('üîß formatLeakOsintResultData called with:', {
        dataType: typeof data,
        isArray: Array.isArray(data),
        length: Array.isArray(data) ? data.length : 'not array',
        keys: data && typeof data === 'object' ? Object.keys(data).slice(0, 3) : 'no keys'
      });
      
      if (!data) {
        console.log('‚ùå formatLeakOsintResultData: No data provided');
        return '<div style="color: #6b7280;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</div>';
      }
      
      const formattedData = {};
      formatLeakOsintData(data, formattedData);
      
      console.log('‚úÖ formatLeakOsintResultData: Formatted data keys:', Object.keys(formattedData));
      
      // –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è LeakOsint –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–µ—Ä–µ–Ω–æ—Å–∞–º–∏ —Å—Ç—Ä–æ–∫
      let html = '<div style="font-family: monospace; line-height: 1.6; white-space: pre-line;">';
      
      for (const [key, value] of Object.entries(formattedData)) {
        if (value !== null && value !== undefined && value !== '') {
          const formattedValue = Array.isArray(value) ? value.join('\n') : String(value);
          html += `<div style="margin-bottom: 20px;"><strong>${key}</strong>\n${formattedValue}</div>`;
        }
      }
      
      html += '</div>';
      
      console.log('üìã formatLeakOsintResultData: Final result length:', html ? html.length : 'null');
      
      return html;
    }

    function formatUsersboxResultData(data) {
      console.log('üîß formatUsersboxResultData called with:', {
        dataType: typeof data,
        isArray: Array.isArray(data),
        length: Array.isArray(data) ? data.length : 'not array',
        keys: data && typeof data === 'object' ? Object.keys(data).slice(0, 3) : 'no keys'
      });
      
      if (!data) {
        console.log('‚ùå formatUsersboxResultData: No data provided');
        return '<div style="color: #6b7280;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</div>';
      }
      
      const formattedData = {};
      formatUsersboxData(data, formattedData);
      
      console.log('‚úÖ formatUsersboxResultData: Formatted data keys:', Object.keys(formattedData));
      
      // –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è Usersbox –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–µ—Ä–µ–Ω–æ—Å–∞–º–∏ —Å—Ç—Ä–æ–∫
      let html = '<div style="font-family: monospace; line-height: 1.6; white-space: pre-line;">';
      
      for (const [key, value] of Object.entries(formattedData)) {
        if (value !== null && value !== undefined && value !== '') {
          const formattedValue = Array.isArray(value) ? value.join('\n') : String(value);
          html += `<div style="margin-bottom: 20px;"><strong>${key}</strong>\n${formattedValue}</div>`;
        }
      }
      
      html += '</div>';
      
      console.log('üìã formatUsersboxResultData: Final result length:', html ? html.length : 'null');
      
      return html;
    }

    function formatResultData(data) {
      if (!data || (typeof data === 'object' && Object.keys(data).length === 0)) {
        return '<div style="color: #6b7280; font-style: italic;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</div>';
      }

      if (typeof data === 'string') {
        return data;
      }

      let html = '<div class="data-grid">';
      
      for (const [key, value] of Object.entries(data)) {
        if (value !== null && value !== undefined && value !== '') {
          const formattedValue = Array.isArray(value) ? value.join(', ') : 
                                 typeof value === 'object' ? JSON.stringify(value, null, 2) : 
                                 String(value);
          
          html += `
            <div class="data-label">${key}</div>
            <div class="data-value">${formattedValue}</div>
          `;
        }
      }
      
      html += '</div>';
      return html;
    }

    // Helper function –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
    function createAuthHeaders() {
      const headers = {
        'Content-Type': 'application/json'
      };
      
      if (authToken) {
        headers['Authorization'] = `Bearer ${authToken}`;
      }
      
      return headers;
    }

    // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞
    async function performSearch() {
      if (currentMode === 'password') {
        // Password mode uses its own button and logic
        return;
      }
      
      const query = q.value.trim();
      if (!query) {
        alert('–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–∏—Å–∫–∞');
        return;
      }

      btn.disabled = true;
      btn.textContent = '–ü–æ–∏—Å–∫...';
      results.innerHTML = '';
      showProgress();

      try {
        await performLeakSearch(query);
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞:', error);
        hideProgress();
        results.innerHTML = `<div class="result-card"><div style="color: #dc2626;">${error.message}</div></div>`;
      } finally {
        btn.disabled = false;
        btn.textContent = '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å';
      }
    }

    // –ü–æ–∏—Å–∫ —É—Ç–µ—á–µ–∫ (–Ω–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Å –∫–Ω–æ–ø–∫–æ–π –ò–ò)
    async function performLeakSearch(query) {
      console.log('üîç Starting leak search for:', query);
      
      const allResults = [];
      const sources = [
        { name: 'ITP', step: 1 },
        { name: 'Dyxless', step: 2 },
        { name: 'LeakOsint', step: 3 },
        { name: 'Usersbox', step: 4 },
        { name: 'Vektor', step: 5 }
      ];

      // –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
      for (const source of sources) {
        updateProgress((source.step / sources.length) * 90, `–ü–æ–∏—Å–∫ –≤ ${source.name}...`);
        
        try {
          const response = await fetch('/api/leak-search-step', {
            method: 'POST',
            headers: createAuthHeaders(),
            body: JSON.stringify({
              query: query,
              field: fieldSel.value,
              step: source.step
            })
          });

          const stepData = await response.json();
          
          if (stepData.result) {
            console.log(`‚úÖ ${source.name} completed:`, stepData.result);
            console.log(`üìä ${source.name} response structure:`, {
              ok: stepData.result.ok,
              itemsType: typeof stepData.result.items,
              itemsKeys: typeof stepData.result.items === 'object' ? Object.keys(stepData.result.items) : 'N/A',
              error: stepData.result.error
            });
            // –î–æ–±–∞–≤–ª—è–µ–º –∏–º—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
            allResults.push({ name: source.name, ...stepData.result });
          } else {
            console.log(`‚ùå ${source.name} failed:`, stepData.error);
            allResults.push({ name: source.name, ok: false, error: stepData.error });
          }
        } catch (error) {
          console.error(`üí• Error in ${source.name}:`, error);
          allResults.push({ name: source.name, ok: false, error: error.message });
        }
        
        await new Promise(resolve => setTimeout(resolve, 300));
      }

      // –°—Ä–∞–∑—É –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—ã—Ä—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
      updateProgress(100, '–ó–∞–≤–µ—Ä—à–µ–Ω–æ');
      setTimeout(() => {
        hideProgress();
        window.displayLeakResultsBySources(allResults);
      }, 500);
    }

    // –ü–æ–∏—Å–∫ –∫–æ–º–ø–∞–Ω–∏–π (—Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
    async function performCompanySearch(query) {
      console.log('üè¢ Starting company search for:', query);
      
      const allResults = [];
      const sources = [
        { name: 'Datanewton', step: 1 },
        { name: 'Checko', step: 2 }
      ];

      // –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º –∫–æ–º–ø–∞–Ω–∏–π
      for (let i = 0; i < sources.length; i++) {
        const source = sources[i];
        const progress = 25 + (i * 25);
        
        updateProgress(progress, `–ü–æ–∏—Å–∫ –≤ ${source.name}...`);
        
        try {
          const response = await fetch('/api/company-search-step', {
            method: 'POST',
            headers: createAuthHeaders(),
            body: JSON.stringify({ inn: query, step: source.step })
          });

          const stepData = await response.json();
          
          if (response.ok && stepData.result) {
            allResults.push(stepData.result);
            console.log(`‚úÖ ${source.name} completed:`, stepData.result);
          } else {
            console.log(`‚ùå ${source.name} failed:`, stepData.error);
            allResults.push({ name: source.name, ok: false, error: stepData.error });
          }
        } catch (error) {
          console.error(`üí• Error in ${source.name}:`, error);
          allResults.push({ name: source.name, ok: false, error: error.message });
        }
        
        await new Promise(resolve => setTimeout(resolve, 300));
      }

      // –î–ª—è –∫–æ–º–ø–∞–Ω–∏–π –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–±–µ–∑ –ò–ò –∫–Ω–æ–ø–∫–∏)
      updateProgress(100, '–ó–∞–≤–µ—Ä—à–µ–Ω–æ');
      setTimeout(() => {
        hideProgress();
        displayCompanyResults(allResults);
      }, 500);
    }

    // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ç–æ—Ä –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è)
    function formatCompanyData(data, sourceName) {
      if (!data || (typeof data === 'object' && Object.keys(data).length === 0)) {
        return '<div style="color: #6b7280; font-style: italic;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</div>';
      }

      if (typeof data === 'string') {
        return data;
      }

      let html = '<div class="data-grid">';
      
      // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–ø–∞–Ω–∏–∏
      if (data.name || data.fullName) {
        html += `
          <div class="data-label">üè¢ –ù–∞–∑–≤–∞–Ω–∏–µ</div>
          <div class="data-value">${data.name || data.fullName}</div>
        `;
      }
      
      if (data.inn) {
        html += `
          <div class="data-label">üÜî –ò–ù–ù</div>
          <div class="data-value">${data.inn}</div>
        `;
      }
      
      if (data.kpp) {
        html += `
          <div class="data-label">üèõÔ∏è –ö–ü–ü</div>
          <div class="data-value">${data.kpp}</div>
        `;
      }
      
      if (data.ogrn) {
        html += `
          <div class="data-label">üìã –û–ì–†–ù</div>
          <div class="data-value">${data.ogrn}</div>
        `;
      }
      
      if (data.address) {
        html += `
          <div class="data-label">üìç –ê–¥—Ä–µ—Å</div>
          <div class="data-value">${data.address}</div>
        `;
      }
      
      if (data.ceo || data.director) {
        html += `
          <div class="data-label">üë®‚Äçüíº –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å</div>
          <div class="data-value">${data.ceo || data.director}</div>
        `;
      }
      
      if (data.status) {
        html += `
          <div class="data-label">üìä –°—Ç–∞—Ç—É—Å</div>
          <div class="data-value">${data.status}</div>
        `;
      }
      
      if (data.registrationDate) {
        html += `
          <div class="data-label">üìÖ –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</div>
          <div class="data-value">${data.registrationDate}</div>
        `;
      }
      
      // –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
      if (data.revenue) {
        html += `
          <div class="data-label">üí∞ –í—ã—Ä—É—á–∫–∞</div>
          <div class="data-value">${formatCurrency(data.revenue)}</div>
        `;
      }
      
      if (data.profit) {
        html += `
          <div class="data-label">üìà –ü—Ä–∏–±—ã–ª—å</div>
          <div class="data-value">${formatCurrency(data.profit)}</div>
        `;
      }
      
      if (data.employees) {
        html += `
          <div class="data-label">üë• –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</div>
          <div class="data-value">${data.employees}</div>
        `;
      }
      
      // –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
      if (data.phone) {
        html += `
          <div class="data-label">üìû –¢–µ–ª–µ—Ñ–æ–Ω</div>
          <div class="data-value">${data.phone}</div>
        `;
      }
      
      if (data.email) {
        html += `
          <div class="data-label">üìß Email</div>
          <div class="data-value">${data.email}</div>
        `;
      }
      
      if (data.website) {
        html += `
          <div class="data-label">üåê –°–∞–π—Ç</div>
          <div class="data-value"><a href="${data.website}" target="_blank" style="color: #2563eb;">${data.website}</a></div>
        `;
      }
      
      // –ï—Å–ª–∏ –µ—Å—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–¥–µ–ª—å–Ω–æ
      if (data.finance && typeof data.finance === 'object') {
        html += '</div>';
        html += '<div style="margin-top: 20px; border-top: 2px solid #e5e7eb; padding-top: 16px;">';
        html += '<h4 style="color: #1f2937; font-weight: 600; margin-bottom: 12px;">üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>';
        html += formatResultData(data.finance);
        return html;
      }
      
      // –ï—Å–ª–∏ –æ—Å—Ç–∞–ª–∏—Å—å –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
      const processedFields = ['name', 'fullName', 'inn', 'kpp', 'ogrn', 'address', 'ceo', 'director', 'status', 'registrationDate', 'revenue', 'profit', 'employees', 'phone', 'email', 'website', 'finance'];
      
      for (const [key, value] of Object.entries(data)) {
        if (!processedFields.includes(key) && value !== null && value !== undefined && value !== '') {
          const formattedValue = Array.isArray(value) ? value.join(', ') : 
                                 typeof value === 'object' ? JSON.stringify(value, null, 2) : 
                                 String(value);
          
          html += `
            <div class="data-label">${key}</div>
            <div class="data-value">${formattedValue}</div>
          `;
        }
      }
      
      html += '</div>';
      return html;
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∫–æ–º–ø–∞–Ω–∏–π (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞)
    function displayCompanyResults(companyResults) {
      results.innerHTML = '';
      
      if (!companyResults || companyResults.length === 0) {
        results.innerHTML = '<div class="result-card"><div style="color: #dc2626;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</div></div>';
        return;
      }

      companyResults.forEach((result, index) => {
        const sourceName = result.name || `–ò—Å—Ç–æ—á–Ω–∏–∫ ${index + 1}`;
        let status = 'success';
        
        if (result.error) {
          status = 'warning';
        } else if (result.ok && result.items) {
          // –î–ª—è –∫–æ–º–ø–∞–Ω–∏–π —Å—á–∏—Ç–∞–µ–º —É—Å–ø–µ—Ö–æ–º –Ω–∞–ª–∏—á–∏–µ –ª—é–±—ã—Ö –¥–∞–Ω–Ω—ã—Ö
          status = 'success';
        }
        
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º formatCompanyData –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        const formattedData = formatCompanyData(result.items || {}, sourceName);
        const item = createResultItem(sourceName, status, formattedData);
        results.appendChild(item);
      });
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
    btn.addEventListener('click', () => {
      console.log('Button clicked! Current mode:', currentMode);
      console.log('Button element:', btn);
      console.log('Query input:', q);
      performSearch();
    });
    
    q.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        console.log('Enter pressed! Current mode:', currentMode);
        performSearch();
      }
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤
    modeLeaks.addEventListener('click', () => {
      setMode('leaks');
    });
    
    modePassword.addEventListener('click', () => {
      setMode('password');
    });

    // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤
    function setMode(mode) {
      currentMode = mode;
      
      // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
      modeLeaks.classList.remove('active');
      modePassword.classList.remove('active');
      
      // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–Ω–æ–ø–∫–µ
      if (mode === 'leaks') {
        modeLeaks.classList.add('active');
        searchInput.style.display = 'block';
        searchInput.style.justifyContent = 'flex-start';
        passwordInput.style.display = 'none';
        fieldSel.style.display = 'inline-block';
        fieldSel.value = 'phone'; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–ª–µ—Ñ–æ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        q.placeholder = '–ù–∞–ø—Ä–∏–º–µ—Ä: +79990000000';
        q.value = '';
      } else if (mode === 'password') {
        modePassword.classList.add('active');
        searchInput.style.display = 'none';
        passwordInput.style.display = 'block';
        fieldSel.style.display = 'none';
      }
      
      // –û—á–∏—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–∏ —Å–º–µ–Ω–µ —Ä–µ–∂–∏–º–∞
      results.innerHTML = '';
    }

    // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    window.toggleResult = toggleResult;

    // AI Loading —Ñ—É–Ω–∫—Ü–∏–∏
    function showAILoading() {
      const overlay = document.getElementById('aiLoadingOverlay');
      if (overlay) {
        overlay.style.display = 'flex';
      }
    }

    function hideAILoading() {
      const overlay = document.getElementById('aiLoadingOverlay');
      if (overlay) {
        overlay.style.display = 'none';
      }
    }

    function updateAIStatus(message) {
      const statusElement = document.querySelector('#aiLoadingOverlay .loading-text');
      if (statusElement) {
        statusElement.textContent = message;
      }
    }

    // –î–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ
    window.showAILoading = showAILoading;
    window.hideAILoading = hideAILoading;
    window.updateAIStatus = updateAIStatus;

    // ===== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –î–õ–Ø –†–ï–ñ–ò–ú–ê –ü–†–û–í–ï–†–ö–ò –ü–ê–†–û–õ–ï–ô =====

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è (–∏—Å–ø–æ–ª—å–∑—É–µ–º —É–∂–µ –æ–±—ä—è–≤–ª–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)
    if (togglePassword && passwordField) {
      togglePassword.addEventListener('click', () => {
        const type = passwordField.type === 'password' ? 'text' : 'password';
        passwordField.type = type;
        togglePassword.textContent = type === 'password' ? 'üëÅÔ∏è' : 'üôà';
      });
    }

    // –ê–Ω–∞–ª–∏–∑ —Å–∏–ª—ã –ø–∞—Ä–æ–ª—è –ø—Ä–∏ –≤–≤–æ–¥–µ
    if (passwordField && passwordStrength) {
      passwordField.addEventListener('input', () => {
        const password = passwordField.value;
        const strength = analyzePasswordStrength(password);
        passwordStrength.innerHTML = strength.html;
      });
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–æ–ª—è
    if (checkPasswordBtn) {
      checkPasswordBtn.addEventListener('click', async () => {
        const password = passwordField.value.trim();
        
        if (!password) {
          alert('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏');
          return;
        }
        
        if (password.length < 1 || password.length > 200) {
          alert('–î–ª–∏–Ω–∞ –ø–∞—Ä–æ–ª—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç 1 –¥–æ 200 —Å–∏–º–≤–æ–ª–æ–≤');
          return;
        }
        
        await checkPasswordSecurity(password);
      });
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ Enter
    if (passwordField) {
      passwordField.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          checkPasswordBtn.click();
        }
      });
    }

    // –§—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ —Å–∏–ª—ã –ø–∞—Ä–æ–ª—è
    function analyzePasswordStrength(password) {
      if (!password) {
        return { score: 0, html: '' };
      }
      
      let score = 0;
      let feedback = [];
      
      // –î–ª–∏–Ω–∞
      if (password.length >= 8) score += 20;
      else feedback.push('–î–ª–∏–Ω–∞ –º–µ–Ω–µ–µ 8 —Å–∏–º–≤–æ–ª–æ–≤');
      
      if (password.length >= 12) score += 10;
      if (password.length >= 16) score += 10;
      
      // –°–∏–º–≤–æ–ª—ã
      if (/[a-z]/.test(password)) score += 10;
      else feedback.push('–ù–µ—Ç —Å—Ç—Ä–æ—á–Ω—ã—Ö –±—É–∫–≤');
      
      if (/[A-Z]/.test(password)) score += 10;
      else feedback.push('–ù–µ—Ç –∑–∞–≥–ª–∞–≤–Ω—ã—Ö –±—É–∫–≤');
      
      if (/[0-9]/.test(password)) score += 10;
      else feedback.push('–ù–µ—Ç —Ü–∏—Ñ—Ä');
      
      if (/[^a-zA-Z0-9]/.test(password)) score += 20;
      else feedback.push('–ù–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤');
      
      // –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å
      const uniqueChars = new Set(password).size;
      if (uniqueChars >= password.length * 0.7) score += 10;
      
      // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —É—Ä–æ–≤–µ–Ω—å
      let level, color, emoji;
      if (score < 30) {
        level = '–°–ª–∞–±—ã–π';
        color = '#dc2626';
        emoji = 'üî¥';
      } else if (score < 60) {
        level = '–°—Ä–µ–¥–Ω–∏–π';
        color = '#f59e0b';
        emoji = 'üü°';
      } else if (score < 80) {
        level = '–•–æ—Ä–æ—à–∏–π';
        color = '#10b981';
        emoji = 'üü¢';
      } else {
        level = '–û—Ç–ª–∏—á–Ω—ã–π';
        color = '#059669';
        emoji = 'üíö';
      }
      
      let html = `
        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
          <span>${emoji}</span>
          <span style="color: ${color}; font-weight: 600;">–°–∏–ª–∞ –ø–∞—Ä–æ–ª—è: ${level}</span>
          <span style="color: #6b7280;">(${score}/100)</span>
        </div>
      `;
      
      if (feedback.length > 0) {
        html += `<div style="color: #6b7280; font-size: 12px;">üí° ${feedback.join(', ')}</div>`;
      }
      
      return { score, html };
    }

    // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–æ–ª—è —á–µ—Ä–µ–∑ API
    async function checkPasswordSecurity(password) {
      const button = checkPasswordBtn;
      const originalText = button.textContent;
      
      button.disabled = true;
      button.textContent = 'üîÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º...';
      
      try {
        console.log('üîê Starting password security check...');
        
        const response = await fetch('/api/password-check', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ password })
        });
        
        const data = await response.json();
        
        if (!response.ok) {
          throw new Error(data.error?.message || '–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–æ–ª—è');
        }
        
        displayPasswordResults(data, password);
        
      } catch (error) {
        console.error('Password check error:', error);
        
        results.innerHTML = `
          <div class="result-card">
            <div style="color: #dc2626;">
              <strong>‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏</strong><br>
              ${error.message || '–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–æ–ª—å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.'}
            </div>
          </div>
        `;
      } finally {
        button.disabled = false;
        button.textContent = originalText;
      }
    }

    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–æ–ª—è
    function displayPasswordResults(data, password) {
      let html = '';
      
      if (data.ok === false) {
        html = `
          <div class="result-card">
            <div style="color: #dc2626;">
              <strong>‚ùå –°–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</strong><br>
              ${data.error?.message || '–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª–µ–π –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞'}
            </div>
          </div>
        `;
      } else if (data.isCompromised) {
        html = `
          <div class="result-card">
            <div class="result-header">
              <div class="result-title">üö® –ü–∞—Ä–æ–ª—å —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω</div>
              <span class="status-badge status-found">–ù–∞–π–¥–µ–Ω</span>
            </div>
            <div class="result-body" style="display: block;">
              <div class="data-grid">
                <div class="data-label">üî¥ –°—Ç–∞—Ç—É—Å</div>
                <div class="data-value">–ü–∞—Ä–æ–ª—å –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–∞—Ö —É—Ç–µ—á–µ–∫</div>
                
                <div class="data-label">üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Ç–µ—á–µ–∫</div>
                <div class="data-value">${data.breachCount || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</div>
                
                <div class="data-label">‚ö†Ô∏è –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞</div>
                <div class="data-value" style="color: #dc2626; font-weight: 600;">–í–´–°–û–ö–ò–ô</div>
                
                <div class="data-label">üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è</div>
                <div class="data-value">
                  <strong style="color: #dc2626;">–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ —Å–º–µ–Ω–∏—Ç–µ —ç—Ç–æ—Ç –ø–∞—Ä–æ–ª—å!</strong><br>
                  –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å –¥–ª–∏–Ω–æ–π –º–∏–Ω–∏–º—É–º 12 —Å–∏–º–≤–æ–ª–æ–≤ —Å –∫–æ–º–±–∏–Ω–∞—Ü–∏–µ–π –±—É–∫–≤, —Ü–∏—Ñ—Ä –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤.
                </div>
              </div>
              
              <div style="margin-top: 16px; padding: 12px; background: #fef2f2; border: 1px solid #fecaca; border-radius: 4px;">
                <strong style="color: #dc2626;">üî• –ö—Ä–∏—Ç–∏—á–Ω–æ:</strong> –≠—Ç–æ—Ç –ø–∞—Ä–æ–ª—å —É–∂–µ –∏–∑–≤–µ—Å—Ç–µ–Ω –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞–º –∏ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∞—Ç–∞–∫ –Ω–∞ –≤–∞—à–∏ –∞–∫–∫–∞—É–Ω—Ç—ã.
              </div>
            </div>
          </div>
        `;
      } else {
        html = `
          <div class="result-card">
            <div class="result-header">
              <div class="result-title">‚úÖ –ü–∞—Ä–æ–ª—å –±–µ–∑–æ–ø–∞—Å–µ–Ω</div>
              <span class="status-badge status-clean">–ß–∏—Å—Ç–æ</span>
            </div>
            <div class="result-body" style="display: block;">
              <div class="data-grid">
                <div class="data-label">üü¢ –°—Ç–∞—Ç—É—Å</div>
                <div class="data-value">–ü–∞—Ä–æ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —É—Ç–µ—á–∫–∞—Ö</div>
                
                <div class="data-label">üîç –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –±–∞–∑</div>
                <div class="data-value">DeHashed (–∫—Ä—É–ø–Ω–µ–π—à–∞—è –±–∞–∑–∞ —É—Ç–µ—á–µ–∫)</div>
                
                <div class="data-label">‚≠ê –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞</div>
                <div class="data-value" style="color: #059669; font-weight: 600;">–ù–ò–ó–ö–ò–ô</div>
                
                <div class="data-label">üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è</div>
                <div class="data-value">
                  –ü–∞—Ä–æ–ª—å –≤—ã–≥–ª—è–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–º, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º:<br>
                  ‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∞–π—Ç–∞<br>
                  ‚Ä¢ –í–∫–ª—é—á–∏—Ç—å –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é<br>
                  ‚Ä¢ –†–µ–≥—É–ª—è—Ä–Ω–æ –º–µ–Ω—è—Ç—å –ø–∞—Ä–æ–ª–∏ (—Ä–∞–∑ –≤ 6-12 –º–µ—Å—è—Ü–µ–≤)
                </div>
              </div>
              
              <div style="margin-top: 16px; padding: 12px; background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 4px;">
                <strong style="color: #059669;">‚ú® –û—Ç–ª–∏—á–Ω–æ:</strong> –≠—Ç–æ—Ç –ø–∞—Ä–æ–ª—å –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω –≤ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –±–∞–∑–∞—Ö —É—Ç–µ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö.
              </div>
            </div>
          </div>
        `;
      }
      
      // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∞–ª–∏–∑ —Å–∏–ª—ã –ø–∞—Ä–æ–ª—è
      const strength = analyzePasswordStrength(password);
      html += `
        <div class="result-card">
          <div class="result-header">
            <div class="result-title">üìä –ê–Ω–∞–ª–∏–∑ —Å–∏–ª—ã –ø–∞—Ä–æ–ª—è</div>
          </div>
          <div class="result-body" style="display: block;">
            ${strength.html}
            
            <div style="margin-top: 16px;">
              <div style="font-weight: 600; margin-bottom: 8px;">üí° –°–æ–≤–µ—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è:</div>
              <ul style="margin: 0; padding-left: 16px; color: #6b7280;">
                <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∏–Ω–∏–º—É–º 12 —Å–∏–º–≤–æ–ª–æ–≤</li>
                <li>–ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ –±—É–∫–≤—ã —Ä–∞–∑–Ω–æ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞</li>
                <li>–î–æ–±–∞–≤–ª—è–π—Ç–µ —Ü–∏—Ñ—Ä—ã –∏ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã (!@#$%^&*)</li>
                <li>–ò–∑–±–µ–≥–∞–π—Ç–µ –ª–∏—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</li>
                <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞—Ä–æ–ª–µ–π</li>
              </ul>
            </div>
          </div>
        </div>
      `;
      
      results.innerHTML = html;
    }

    // Nothing OS Dashboard Functions
    window.displayNothingDashboard = function(sourceResults) {
      console.log('üé® Creating Nothing OS dashboard for:', sourceResults);
      
      const dashboardData = analyzeNothingDashboardData(sourceResults);
      
      document.getElementById('resultsContainer').innerHTML = `
        <div class="dashboard-container">
          <!-- Header Section -->
          <div class="dashboard-header">
            <div class="dashboard-title">
              <h1>–ê–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h1>
              <p>–ö–û–ú–ü–õ–ï–ö–°–ù–û–ï –°–ö–ê–ù–ò–†–û–í–ê–ù–ò–ï –¶–ò–§–†–û–í–û–ì–û –°–õ–ï–î–ê –ó–ê–í–ï–†–®–ï–ù–û</p>
              <p>–û–ë–ù–ê–†–£–ñ–ï–ù–û <strong>${dashboardData.totalBreaches}</strong> –£–¢–ï–ß–ï–ö –î–ê–ù–ù–´–• –í <strong>${dashboardData.affectedSources}</strong> –ò–°–¢–û–ß–ù–ò–ö–ê–•</p>
            </div>
            
            <!-- Stats Grid -->
            <div class="dashboard-stats">
              <div class="stat-card ${dashboardData.foundBreaches > 0 ? 'pulse-red' : ''}">
                <div class="stat-number">${dashboardData.foundBreaches}</div>
                <div class="stat-label">–ù–ê–ô–î–ï–ù–û –£–¢–ï–ß–ï–ö</div>
              </div>
              <div class="stat-card">
                <div class="stat-number">${dashboardData.cleanSources}</div>
                <div class="stat-label">–ß–ò–°–¢–´–• –ò–°–¢–û–ß–ù–ò–ö–û–í</div>
              </div>
              <div class="stat-card">
                <div class="stat-number">${dashboardData.totalBreaches}</div>
                <div class="stat-label">–í–°–ï–ì–û –ó–ê–ü–ò–°–ï–ô</div>
              </div>
              <div class="stat-card ${dashboardData.errorSources > 0 ? 'pulse-red' : ''}">
                <div class="stat-number">${dashboardData.errorSources}</div>
                <div class="stat-label">–û–®–ò–ë–û–ö –°–ö–ê–ù–ò–†–û–í–ê–ù–ò–Ø</div>
              </div>
            </div>
            
            <!-- Risk Indicator -->
            <div class="risk-indicator">
              <div class="risk-circle ${getRiskClass(dashboardData)}">
                <div class="risk-count">${dashboardData.foundBreaches}</div>
                <div class="risk-level">${getRiskLevel(dashboardData)}</div>
              </div>
            </div>
          </div>

          <!-- Action Section -->
          ${dashboardData.foundBreaches > 0 ? `
          <div class="action-section">
            <h2>–¢–†–ï–ë–£–Æ–¢–°–Ø –ù–ï–ú–ï–î–õ–ï–ù–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø</h2>
            <p>–í–ê–®–ò –î–ê–ù–ù–´–ï –°–ö–û–ú–ü–†–û–ú–ï–¢–ò–†–û–í–ê–ù–´. –°–õ–ï–î–£–ô–¢–ï –ü–†–û–¢–û–ö–û–õ–£ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò.</p>
            <div class="action-buttons">
              <button id="nothingFixBtn" class="nothing-btn danger">
                üö® –ó–ê–ü–£–°–¢–ò–¢–¨ –ü–†–û–¢–û–ö–û–õ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
              </button>
              <button id="nothingAIBtn" class="nothing-btn">
                ü§ñ –ê–ù–ê–õ–ò–ó –£–ì–†–û–ó –ò–ò
              </button>
            </div>
          </div>
          ` : `
          <div class="action-section">
            <h2>–°–¢–ê–¢–£–° –°–ò–°–¢–ï–ú–´: –ë–ï–ó–û–ü–ê–°–ù–û</h2>
            <p>–ù–ï–ú–ï–î–õ–ï–ù–ù–´–• –£–ì–†–û–ó –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–û. –ü–†–û–î–û–õ–ñ–ê–ô–¢–ï –ú–û–ù–ò–¢–û–†–ò–ù–ì.</p>
            <div class="action-buttons">
              <button id="nothingAIBtn" class="nothing-btn">
                üìä –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó
              </button>
            </div>
          </div>
          `}

          <!-- Data Table -->
          <div class="breaches-section">
            <h2>–†–ï–ó–£–õ–¨–¢–ê–¢–´ –ê–ù–ê–õ–ò–ó–ê –ò–°–¢–û–ß–ù–ò–ö–û–í</h2>
            <p>–ü–†–û–í–ï–†–ï–ù–û ${sourceResults.length} –ë–ê–ó –î–ê–ù–ù–´–• –ù–ê –ù–ê–õ–ò–ß–ò–ï –¶–ò–§–†–û–í–´–• –°–õ–ï–î–û–í</p>
            
            <div class="table-filters">
              <button class="nothing-filter-btn active" data-filter="all">
                –í–°–ï –ò–°–¢–û–ß–ù–ò–ö–ò (${sourceResults.length})
              </button>
              <button class="nothing-filter-btn" data-filter="breaches">
                –°–ö–û–ú–ü–†–û–ú–ï–¢–ò–†–û–í–ê–ù–´ (${dashboardData.foundBreaches})
              </button>
              <button class="nothing-filter-btn" data-filter="clean">
                –ë–ï–ó–û–ü–ê–°–ù–´ (${dashboardData.cleanSources})
              </button>
              <button class="nothing-filter-btn" data-filter="errors">
                –û–®–ò–ë–ö–ò (${dashboardData.errorSources})
              </button>
            </div>
            
            <table class="nothing-table">
              <thead>
                <tr>
                  <th>–ë–ê–ó–ê –î–ê–ù–ù–´–• –ò–°–¢–û–ß–ù–ò–ö–ê</th>
                  <th>–î–ê–¢–ê –°–ö–ê–ù–ò–†–û–í–ê–ù–ò–Ø</th>
                  <th>–°–¢–ê–¢–£–°</th>
                  <th>–î–ï–ô–°–¢–í–ò–ï</th>
                </tr>
              </thead>
              <tbody>
                ${generateNothingTableRows(sourceResults)}
              </tbody>
            </table>
          </div>
        </div>
      `;

      setupNothingDashboardHandlers(sourceResults);
    };

    function analyzeNothingDashboardData(sourceResults) {
      let totalBreaches = 0;
      let foundBreaches = 0;
      let cleanSources = 0;
      let errorSources = 0;
      let affectedSources = 0;

      sourceResults.forEach(result => {
        if (result.error) {
          errorSources++;
        } else if (result.ok && result.items) {
          const hasData = window.checkIfSourceHasLeakData(result, result.name);
          if (hasData) {
            foundBreaches++;
            affectedSources++;
            
            if (result.name === 'ITP' && typeof result.items === 'object') {
              Object.values(result.items).forEach(db => {
                if (db.data) totalBreaches += db.data.length;
              });
            } else if (Array.isArray(result.items)) {
              totalBreaches += result.items.length;
            } else {
              totalBreaches += 1;
            }
          } else {
            cleanSources++;
          }
        }
      });

      return {
        totalBreaches,
        foundBreaches,
        cleanSources,
        errorSources,
        affectedSources
      };
    }

    function getRiskClass(data) {
      if (data.foundBreaches >= 3) return 'high-risk';
      if (data.foundBreaches >= 1) return 'medium-risk';
      return 'low-risk';
    }

    function getRiskLevel(data) {
      if (data.foundBreaches >= 3) return '–í–´–°–û–ö–ò–ô –†–ò–°–ö';
      if (data.foundBreaches >= 1) return '–†–ò–°–ö –û–ë–ù–ê–†–£–ñ–ï–ù';
      return '–ë–ï–ó–û–ü–ê–°–ù–û';
    }

    function generateNothingTableRows(sourceResults) {
      return sourceResults.map(result => {
        const sourceName = result.name || 'UNKNOWN';
        const currentDate = new Date().toLocaleDateString('en-US');
        
        let status, statusClass, statusText;
        
        if (result.error) {
          status = 'ERROR';
          statusClass = 'status-error';
          statusText = '–û–®–ò–ë–ö–ê –°–ö–ê–ù–ò–†–û–í–ê–ù–ò–Ø';
        } else if (result.ok && result.items) {
          const hasData = window.checkIfSourceHasLeakData(result, sourceName);
          if (hasData) {
            status = 'COMPROMISED';
            statusClass = 'status-breach';
            statusText = '–î–ê–ù–ù–´–ï –ù–ê–ô–î–ï–ù–´';
          } else {
            status = 'SECURE';
            statusClass = 'status-clean';
            statusText = '–£–ì–†–û–ó –ù–ï–¢';
          }
        } else {
          status = 'UNKNOWN';
          statusClass = 'status-error';
          statusText = '–ù–ï–¢ –î–ê–ù–ù–´–•';
        }

        return `
          <tr class="table-row" data-status="${statusClass}">
            <td>
              <div class="source-info">
                <div class="source-icon">${getNothingSourceIcon(sourceName)}</div>
                <div>
                  <div class="source-name">${sourceName}</div>
                  <div class="source-description">${getNothingSourceDescription(sourceName)}</div>
                </div>
              </div>
            </td>
            <td>${currentDate}</td>
            <td>
              <span class="nothing-status-badge ${statusClass}">
                ${statusText}
              </span>
            </td>
            <td>
              <button class="nothing-details-btn" onclick="showNothingSourceDetails('${sourceName}', ${JSON.stringify(result).replace(/"/g, '&quot;')})">
                –ü–û–î–†–û–ë–ù–ï–ï
              </button>
            </td>
          </tr>
        `;
      }).join('');
    }

    function getNothingSourceIcon(sourceName) {
      const icons = {
        'ITP': '‚óâ',
        'Dyxless': '‚óé', 
        'LeakOsint': '‚äô',
        'Usersbox': '‚äó',
        'Vektor': '‚äò'
      };
      return icons[sourceName] || '‚óã';
    }

    function getNothingSourceDescription(sourceName) {
      const descriptions = {
        'ITP': '–ë–ê–ó–ê –†–ê–ó–í–ï–î–î–ê–ù–ù–´–•',
        'Dyxless': '–ö–û–õ–õ–ï–ö–¶–ò–Ø –£–¢–ï–ß–ï–ö',
        'LeakOsint': 'OSINT –†–ï–ü–û–ó–ò–¢–û–†–ò–ô',
        'Usersbox': '–ê–†–•–ò–í –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô',
        'Vektor': '–í–ï–ö–¢–û–†–ù–ê–Ø –ë–ê–ó–ê'
      };
      return descriptions[sourceName] || '–ò–°–¢–û–ß–ù–ò–ö –î–ê–ù–ù–´–•';
    }

    function setupNothingDashboardHandlers(sourceResults) {
      // Fix button
      const fixBtn = document.getElementById('nothingFixBtn');
      if (fixBtn) {
        fixBtn.addEventListener('click', () => {
          showNothingFixProtocol(sourceResults);
        });
      }

      // AI button
      const aiBtn = document.getElementById('nothingAIBtn');
      if (aiBtn) {
        aiBtn.addEventListener('click', async () => {
          await performAIAnalysis(sourceResults);
        });
      }

      // Filter buttons
      document.querySelectorAll('.nothing-filter-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          document.querySelectorAll('.nothing-filter-btn').forEach(b => b.classList.remove('active'));
          e.target.classList.add('active');
          
          const filter = e.target.dataset.filter;
          filterNothingTable(filter);
        });
      });
    }

    function filterNothingTable(filter) {
      const rows = document.querySelectorAll('.table-row');
      
      rows.forEach(row => {
        const status = row.dataset.status;
        
        if (filter === 'all') {
          row.style.display = '';
        } else if (filter === 'breaches' && status === 'status-breach') {
          row.style.display = '';
        } else if (filter === 'clean' && status === 'status-clean') {
          row.style.display = '';
        } else if (filter === 'errors' && status === 'status-error') {
          row.style.display = '';
        } else {
          row.style.display = 'none';
        }
      });
    }

    window.showNothingSourceDetails = function(sourceName, result) {
      const modal = document.createElement('div');
      modal.className = 'nothing-modal';
      modal.innerHTML = `
        <div class="nothing-modal-content">
          <div class="nothing-modal-header">
            <h3>${getNothingSourceIcon(sourceName)} ${sourceName} - –î–ï–¢–ê–õ–¨–ù–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´ –°–ö–ê–ù–ò–†–û–í–ê–ù–ò–Ø</h3>
            <button class="nothing-modal-close" onclick="this.closest('.nothing-modal').remove()">√ó</button>
          </div>
          <div class="nothing-modal-body">
            ${formatResultDataBySource(result.items || result.error, sourceName)}
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
    };

    function showNothingFixProtocol(sourceResults) {
      const modal = document.createElement('div');
      modal.className = 'nothing-modal';
      modal.innerHTML = `
        <div class="nothing-modal-content">
          <div class="nothing-modal-header">
            <h2>üö® –ü–†–û–¢–û–ö–û–õ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò –ó–ê–ü–£–©–ï–ù</h2>
            <button class="nothing-modal-close" onclick="this.closest('.nothing-modal').remove()">√ó</button>
          </div>
          <div class="nothing-modal-body">
            <div style="margin-bottom: 24px;">
              <h3 style="color: #ff0000; margin-bottom: 16px;">–§–ê–ó–ê 1: –ù–ï–ú–ï–î–õ–ï–ù–ù–ê–Ø –ò–ó–û–õ–Ø–¶–ò–Ø</h3>
              <ul style="list-style: none; padding: 0;">
                <li style="padding: 8px 0; border-bottom: 1px solid #333;">üîê –°–ú–ï–ù–ò–¢–ï –í–°–ï –ü–ê–†–û–õ–ò –ê–ö–ö–ê–£–ù–¢–û–í</li>
                <li style="padding: 8px 0; border-bottom: 1px solid #333;">üì± –í–ö–õ–Æ–ß–ò–¢–ï 2FA –ù–ê –í–°–ï–• –°–ï–†–í–ò–°–ê–•</li>
                <li style="padding: 8px 0; border-bottom: 1px solid #333;">üè¶ –ü–†–û–í–ï–†–¨–¢–ï –§–ò–ù–ê–ù–°–û–í–´–ï –ê–ö–ö–ê–£–ù–¢–´</li>
                <li style="padding: 8px 0; border-bottom: 1px solid #333;">üìß –ó–ê–©–ò–¢–ò–¢–ï EMAIL –ê–ö–ö–ê–£–ù–¢–´</li>
              </ul>
              <button class="nothing-btn" style="margin-top: 16px;" onclick="nextProtocolPhase(this)">
                –§–ê–ó–ê 1 –ó–ê–í–ï–†–®–ï–ù–ê
              </button>
            </div>
            
            <div style="margin-bottom: 24px; display: none;" data-phase="2">
              <h3 style="color: #ffffff; margin-bottom: 16px;">–§–ê–ó–ê 2: –ù–ê–°–¢–†–û–ô–ö–ê –ú–û–ù–ò–¢–û–†–ò–ù–ì–ê</h3>
              <ul style="list-style: none; padding: 0;">
                <li style="padding: 8px 0; border-bottom: 1px solid #333;">üîî –ù–ê–°–¢–†–û–ô–¢–ï –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø –û –£–¢–ï–ß–ö–ê–•</li>
                <li style="padding: 8px 0; border-bottom: 1px solid #333;">üìä –ü–û–î–ö–õ–Æ–ß–ò–¢–ï –ö–†–ï–î–ò–¢–ù–´–ô –ú–û–ù–ò–¢–û–†–ò–ù–ì</li>
                <li style="padding: 8px 0; border-bottom: 1px solid #333;">üëÄ –í–ö–õ–Æ–ß–ò–¢–ï –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø –ê–ö–ö–ê–£–ù–¢–û–í</li>
                <li style="padding: 8px 0; border-bottom: 1px solid #333;">üîÑ –ó–ê–ü–õ–ê–ù–ò–†–£–ô–¢–ï –†–ï–ì–£–õ–Ø–†–ù–´–ï –°–ö–ê–ù–ò–†–û–í–ê–ù–ò–Ø</li>
              </ul>
              <button class="nothing-btn" style="margin-top: 16px;" onclick="nextProtocolPhase(this)">
                –ü–†–û–¢–û–ö–û–õ –ó–ê–í–ï–†–®–ï–ù
              </button>
            </div>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
    }

    window.nextProtocolPhase = function(button) {
      const currentPhase = button.closest('[data-phase], div:not([data-phase])');
      const nextPhase = document.querySelector('[data-phase="2"]');
      
      if (nextPhase && nextPhase.style.display === 'none') {
        currentPhase.style.display = 'none';
        nextPhase.style.display = 'block';
      } else {
        document.querySelector('.nothing-modal').remove();
        alert('üéØ –ü–†–û–¢–û–ö–û–õ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò –ó–ê–í–ï–†–®–ï–ù. –í–ê–® –¶–ò–§–†–û–í–û–ô –°–õ–ï–î –¢–ï–ü–ï–†–¨ –ó–ê–©–ò–©–ï–ù.');
      }
    };

    // ===== –ö–û–†–ü–û–†–ê–¢–ò–í–ù–´–ô –ò–ù–¢–ï–†–§–ï–ô–° =====
    
    // –≠–ª–µ–º–µ–Ω—Ç—ã –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    const corporateBtn = document.getElementById('corporateBtn');
    const corporateInterface = document.getElementById('corporateInterface');
    const backToMainBtn = document.getElementById('backToMainBtn');
    
    // –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ–∂–∏–º—ã
    const corpModeCompany = document.getElementById('corpModeCompany');
    const corpModeEmployee = document.getElementById('corpModeEmployee');
    const corpModeDomain = document.getElementById('corpModeDomain');
    const corpModeBatch = document.getElementById('corpModeBatch');
    
    // –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ–æ—Ä–º—ã
    const corporateSearchInput = document.getElementById('corporateSearchInput');
    const employeeSearchInput = document.getElementById('employeeSearchInput');
    const domainSearchInput = document.getElementById('domainSearchInput');
    const batchSearchInput = document.getElementById('batchSearchInput');
    
    // –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –ø–æ–∏—Å–∫–∞
    const corporateSearchBtn = document.getElementById('corporateSearchBtn');
    const employeeSearchBtn = document.getElementById('employeeSearchBtn');
    const domainSearchBtn = document.getElementById('domainSearchBtn');
    const batchSearchBtn = document.getElementById('batchSearchBtn');
    
    // –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    const corporateProgressContainer = document.getElementById('corporateProgressContainer');
    const corporateProgressFill = document.getElementById('corporateProgressFill');
    const corporateProgressStatus = document.getElementById('corporateProgressStatus');
    const corporateProgressPercent = document.getElementById('corporateProgressPercent');
    const corporateResults = document.getElementById('corporateResults');
    
    let currentCorporateMode = 'company';
    
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    if (corporateBtn) {
      corporateBtn.addEventListener('click', () => {
        showCorporateInterface();
      });
    }
    
    // –í–æ–∑–≤—Ä–∞—Ç –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É
    if (backToMainBtn) {
      backToMainBtn.addEventListener('click', () => {
        showMainInterface();
      });
    }
    
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤
    if (corpModeCompany) {
      corpModeCompany.addEventListener('click', () => {
        setCorporateMode('company');
      });
    }
    
    if (corpModeEmployee) {
      corpModeEmployee.addEventListener('click', () => {
        setCorporateMode('employee');
      });
    }
    
    if (corpModeDomain) {
      corpModeDomain.addEventListener('click', () => {
        setCorporateMode('domain');
      });
    }
    
    if (corpModeBatch) {
      corpModeBatch.addEventListener('click', () => {
        setCorporateMode('batch');
      });
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
    if (corporateSearchBtn) {
      corporateSearchBtn.addEventListener('click', () => {
        performCorporateCompanySearch();
      });
    }
    
    if (employeeSearchBtn) {
      employeeSearchBtn.addEventListener('click', () => {
        performEmployeeSearch();
      });
    }
    
    if (domainSearchBtn) {
      domainSearchBtn.addEventListener('click', () => {
        performDomainSearch();
      });
    }
    
    if (batchSearchBtn) {
      batchSearchBtn.addEventListener('click', () => {
        performBatchSearch();
      });
    }
    
    // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    function showCorporateInterface() {
      // –°–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–ª–Ω–æ—Å—Ç—å—é
      document.querySelector('header').style.display = 'none';
      document.querySelector('body > div.container').style.display = 'none';
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
      corporateInterface.style.display = 'block';
      corporateInterface.style.position = 'fixed';
      corporateInterface.style.top = '0';
      corporateInterface.style.left = '0';
      corporateInterface.style.width = '100%';
      corporateInterface.style.height = '100vh';
      corporateInterface.style.zIndex = '9999';
      corporateInterface.style.backgroundColor = '#ffffff';
      corporateInterface.style.overflow = 'auto';
      
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–µ–∂–∏–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
      setCorporateMode('company');
      
      console.log('üè¢ Switched to corporate interface as separate page');
    }
    
    // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    function showMainInterface() {
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
      document.querySelector('header').style.display = 'block';
      document.querySelector('body > div.container').style.display = 'block';
      
      // –°–∫—Ä—ã–≤–∞–µ–º –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
      corporateInterface.style.display = 'none';
      corporateInterface.style.position = '';
      corporateInterface.style.top = '';
      corporateInterface.style.left = '';
      corporateInterface.style.width = '';
      corporateInterface.style.height = '';
      corporateInterface.style.zIndex = '';
      corporateInterface.style.backgroundColor = '';
      corporateInterface.style.overflow = '';
      
      console.log('üè† Switched back to main interface');
    }
    
    // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤
    function setCorporateMode(mode) {
      currentCorporateMode = mode;
      
      // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
      document.querySelectorAll('#corporateInterface .btn-secondary').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ñ–æ—Ä–º—ã
      corporateSearchInput.style.display = 'none';
      employeeSearchInput.style.display = 'none';
      domainSearchInput.style.display = 'none';
      batchSearchInput.style.display = 'none';
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é —Ñ–æ—Ä–º—É –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
      if (mode === 'company') {
        corpModeCompany.classList.add('active');
        corporateSearchInput.style.display = 'block';
      } else if (mode === 'employee') {
        corpModeEmployee.classList.add('active');
        employeeSearchInput.style.display = 'block';
      } else if (mode === 'domain') {
        corpModeDomain.classList.add('active');
        domainSearchInput.style.display = 'block';
      } else if (mode === 'batch') {
        corpModeBatch.classList.add('active');
        batchSearchInput.style.display = 'block';
      }
      
      // –û—á–∏—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
      corporateResults.innerHTML = '';
      hideCorporateProgress();
      
      console.log(`üîÑ Corporate mode set to: ${mode}`);
    }
    
    // –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    function showCorporateProgress() {
      corporateProgressContainer.style.display = 'block';
      resetCorporateProgress();
    }
    
    function hideCorporateProgress() {
      corporateProgressContainer.style.display = 'none';
    }
    
    function resetCorporateProgress() {
      corporateProgressFill.style.width = '0%';
      corporateProgressPercent.textContent = '0%';
      corporateProgressStatus.textContent = '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...';
    }
    
    function updateCorporateProgress(percentage, statusText) {
      corporateProgressFill.style.width = percentage + '%';
      corporateProgressPercent.textContent = Math.round(percentage) + '%';
      corporateProgressStatus.textContent = statusText;
    }
    
    // –ü–æ–∏—Å–∫ –∫–æ–º–ø–∞–Ω–∏–∏ –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ
    async function performCorporateCompanySearch() {
      const inn = document.getElementById('corporateInn').value.trim();
      const name = document.getElementById('corporateName').value.trim();
      
      if (!inn && !name) {
        alert('–í–≤–µ–¥–∏—Ç–µ –ò–ù–ù –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏');
        return;
      }
      
      corporateSearchBtn.disabled = true;
      corporateSearchBtn.textContent = 'üîÑ –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º...';
      corporateResults.innerHTML = '';
      showCorporateProgress();
      
      try {
        console.log('üè¢ Starting corporate company search:', { inn, name });
        
        updateCorporateProgress(25, '–ü–æ–∏—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏...');
        
        const response = await fetch('/api/company-search', {
          method: 'POST',
          headers: createAuthHeaders(),
          body: JSON.stringify({
            query: inn || name,
            mode: 'corporate'
          })
        });
        
        updateCorporateProgress(75, '–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤...');
        
        const data = await response.json();
        
        updateCorporateProgress(100, '–ó–∞–≤–µ—Ä—à–µ–Ω–æ');
        
        setTimeout(() => {
          hideCorporateProgress();
          displayCorporateCompanyResults(data, inn, name);
        }, 500);
        
      } catch (error) {
        console.error('Corporate company search error:', error);
        hideCorporateProgress();
        corporateResults.innerHTML = `
          <div class="result-card">
            <div style="color: #dc2626;">
              <strong>‚ùå –û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞</strong><br>
              ${error.message}
            </div>
          </div>
        `;
      } finally {
        corporateSearchBtn.disabled = false;
        corporateSearchBtn.textContent = 'üîç –ù–∞—á–∞—Ç—å –∞–Ω–∞–ª–∏–∑';
      }
    }
    
    // –ü–æ–∏—Å–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
    async function performEmployeeSearch() {
      const field = document.getElementById('employeeField').value;
      const data = document.getElementById('employeeData').value.trim();
      
      if (!data) {
        alert('–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞');
        return;
      }
      
      employeeSearchBtn.disabled = true;
      employeeSearchBtn.textContent = 'üîÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º...';
      corporateResults.innerHTML = '';
      showCorporateProgress();
      
      try {
        console.log('üë§ Starting employee search:', { field, data });
        
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—Ç –∂–µ API —á—Ç–æ –∏ –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ —É—Ç–µ—á–µ–∫
        const allResults = [];
        const sources = [
          { name: 'ITP', step: 1 },
          { name: 'Dyxless', step: 2 },
          { name: 'LeakOsint', step: 3 },
          { name: 'Usersbox', step: 4 },
          { name: 'Vektor', step: 5 }
        ];

        for (const source of sources) {
          updateCorporateProgress((source.step / sources.length) * 90, `–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ ${source.name}...`);
          
          try {
            const response = await fetch('/api/leak-search-step', {
              method: 'POST',
              headers: createAuthHeaders(),
              body: JSON.stringify({
                query: data,
                field: field,
                step: source.step,
                mode: 'employee'
              })
            });

            const stepData = await response.json();
            
            if (stepData.result) {
              allResults.push({ name: source.name, ...stepData.result });
            } else {
              allResults.push({ name: source.name, ok: false, error: stepData.error });
            }
          } catch (error) {
            console.error(`Error in ${source.name}:`, error);
            allResults.push({ name: source.name, ok: false, error: error.message });
          }
          
          await new Promise(resolve => setTimeout(resolve, 300));
        }
        
        updateCorporateProgress(100, '–ó–∞–≤–µ—Ä—à–µ–Ω–æ');
        
        setTimeout(() => {
          hideCorporateProgress();
          displayEmployeeResults(allResults, data, field);
        }, 500);
        
      } catch (error) {
        console.error('Employee search error:', error);
        hideCorporateProgress();
        corporateResults.innerHTML = `
          <div class="result-card">
            <div style="color: #dc2626;">
              <strong>‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏</strong><br>
              ${error.message}
            </div>
          </div>
        `;
      } finally {
        employeeSearchBtn.disabled = false;
        employeeSearchBtn.textContent = 'üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞';
      }
    }
    
    // –ü–æ–∏—Å–∫ –ø–æ –¥–æ–º–µ–Ω—É —á–µ—Ä–µ–∑ Snusbase
    async function performDomainSearch() {
      const domain = document.getElementById('domainName').value.trim();
      
      if (!domain) {
        alert('–í–≤–µ–¥–∏—Ç–µ –¥–æ–º–µ–Ω –¥–ª—è –ø–æ–∏—Å–∫–∞');
        return;
      }
      
      // –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–æ–º–µ–Ω–∞
      const domainRegex = /^[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9]?\.[a-zA-Z]{2,}$/;
      if (!domainRegex.test(domain)) {
        alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –¥–æ–º–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä: company.com)');
        return;
      }
      
      domainSearchBtn.disabled = true;
      domainSearchBtn.textContent = 'üîÑ –ò—â–µ–º —É—Ç–µ—á–∫–∏...';
      corporateResults.innerHTML = '';
      showCorporateProgress();
      
      try {
        console.log('üåê Starting domain search for:', domain);
        
        updateCorporateProgress(10, '–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Snusbase...');
        
        // –í—ã–∑—ã–≤–∞–µ–º API –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –¥–æ–º–µ–Ω—É
        const response = await fetch('/api/snusbase/domain-search', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${localStorage.getItem('token')}`
          },
          body: JSON.stringify({ domain })
        });
        
        updateCorporateProgress(50, '–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤...');
        
        if (!response.ok) {
          throw new Error(`API error: ${response.status}`);
        }
        
        const data = await response.json();
        updateCorporateProgress(80, '–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö...');
        
        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        displayDomainResults(data, domain);
        updateCorporateProgress(100, '–ü–æ–∏—Å–∫ –∑–∞–≤–µ—Ä—à–µ–Ω');
        
        setTimeout(() => {
          hideCorporateProgress();
        }, 1000);
        
      } catch (error) {
        console.error('‚ùå Domain search error:', error);
        corporateResults.innerHTML = `
          <div class="alert alert-error">
            <strong>–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞:</strong> ${error.message}
          </div>
        `;
        hideCorporateProgress();
      } finally {
        domainSearchBtn.disabled = false;
        domainSearchBtn.textContent = 'üîç –ù–∞–π—Ç–∏ —É—Ç–µ—á–∫–∏';
      }
    }
    
    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ –ø–æ –¥–æ–º–µ–Ω—É
    function displayDomainResults(data, domain) {
      if (!data.results || data.results.length === 0) {
        corporateResults.innerHTML = `
          <div class="alert alert-info">
            <h3>üéâ –û—Ç–ª–∏—á–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏!</h3>
            <p>–ü–æ –¥–æ–º–µ–Ω—É <strong>${domain}</strong> —É—Ç–µ—á–µ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.</p>
          </div>
        `;
        return;
      }
      
      // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö
      const groupedResults = {};
      data.results.forEach(result => {
        const dbName = result.database || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –±–∞–∑–∞';
        if (!groupedResults[dbName]) {
          groupedResults[dbName] = [];
        }
        groupedResults[dbName].push(result);
      });
      
      let html = `
        <div class="alert alert-warning">
          <h3>üö® –ù–∞–π–¥–µ–Ω—ã —É—Ç–µ—á–∫–∏ –¥–ª—è –¥–æ–º–µ–Ω–∞ ${domain}</h3>
          <p>–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ <strong>${data.results.length}</strong> –∑–∞–ø–∏—Å–µ–π –≤ <strong>${Object.keys(groupedResults).length}</strong> –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö.</p>
        </div>
        
        <div class="domain-results">
      `;
      
      // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –∫–∞–∂–¥–æ–π –±–∞–∑–µ
      Object.entries(groupedResults).forEach(([dbName, results]) => {
        // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤ —ç—Ç–æ–π –±–∞–∑–µ
        const dataTypes = {
          emails: results.filter(r => r.email).length,
          passwords: results.filter(r => r.password).length,
          hashes: results.filter(r => r.hash).length,
          names: results.filter(r => r.name).length,
          phones: results.filter(r => r.phone).length,
          addresses: results.filter(r => r.address || r.city || r.country).length
        };
        
        html += `
          <div class="database-group">
            <h4>üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: ${dbName}</h4>
            <div class="db-stats">
              <p><strong>–ù–∞–π–¥–µ–Ω–æ –∑–∞–ø–∏—Å–µ–π:</strong> ${results.length}</p>
              <div class="data-types-summary">
                ${dataTypes.emails > 0 ? `<span class="data-type-badge">üìß Email: ${dataTypes.emails}</span>` : ''}
                ${dataTypes.names > 0 ? `<span class="data-type-badge">üë§ –ò–º–µ–Ω–∞: ${dataTypes.names}</span>` : ''}
                ${dataTypes.phones > 0 ? `<span class="data-type-badge">üì± –¢–µ–ª–µ—Ñ–æ–Ω—ã: ${dataTypes.phones}</span>` : ''}
                ${dataTypes.passwords > 0 ? `<span class="data-type-badge critical">üîë –ü–∞—Ä–æ–ª–∏: ${dataTypes.passwords}</span>` : ''}
                ${dataTypes.hashes > 0 ? `<span class="data-type-badge warning">üîê –•–µ—à–∏: ${dataTypes.hashes}</span>` : ''}
                ${dataTypes.addresses > 0 ? `<span class="data-type-badge">üè† –ê–¥—Ä–µ—Å–∞: ${dataTypes.addresses}</span>` : ''}
              </div>
            </div>
            
            <div class="records-preview">
        `;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 5 –∑–∞–ø–∏—Å–µ–π
        results.slice(0, 5).forEach(record => {
          html += `
            <div class="record-item">
              <div class="record-email">üìß ${record.email || 'Email —Å–∫—Ä—ã—Ç'}</div>
              <div class="record-details">
                ${record.name ? `<div class="record-field"><strong>üë§ –ò–º—è:</strong> ${record.name}</div>` : ''}
                ${record.phone ? `<div class="record-field"><strong>üì± –¢–µ–ª–µ—Ñ–æ–Ω:</strong> ${record.phone}</div>` : ''}
                ${record.password ? `<div class="record-field"><strong>üîë –ü–∞—Ä–æ–ª—å:</strong> <span class="password-hidden">${record.password.length > 20 ? record.password.substring(0, 20) + '...' : record.password}</span></div>` : ''}
                ${record.hash ? `<div class="record-field"><strong>üîê –•–µ—à:</strong> <span class="hash-preview">${record.hash.substring(0, 16)}...</span></div>` : ''}
                ${record.address ? `<div class="record-field"><strong>üè† –ê–¥—Ä–µ—Å:</strong> ${record.address}</div>` : ''}
                ${record.city ? `<div class="record-field"><strong>üèôÔ∏è –ì–æ—Ä–æ–¥:</strong> ${record.city}</div>` : ''}
                ${record.country ? `<div class="record-field"><strong>üåç –°—Ç—Ä–∞–Ω–∞:</strong> ${record.country}</div>` : ''}
                ${record.birthdate && record.birthdate !== '0000-00-00' ? `<div class="record-field"><strong>üéÇ –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</strong> ${record.birthdate}</div>` : ''}
                ${record.gender ? `<div class="record-field"><strong>‚ößÔ∏è –ü–æ–ª:</strong> ${record.gender}</div>` : ''}
                ${record.job ? `<div class="record-field"><strong>üíº –†–∞–±–æ—Ç–∞:</strong> ${record.job}</div>` : ''}
                ${record.company ? `<div class="record-field"><strong>üè¢ –ö–æ–º–ø–∞–Ω–∏—è:</strong> ${record.company}</div>` : ''}
                ${record.created ? `<div class="record-field"><strong>üìÖ –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</strong> ${new Date(record.created).toLocaleDateString('ru-RU')}</div>` : ''}
                ${record.lastip ? `<div class="record-field"><strong>üåê –ü–æ—Å–ª–µ–¥–Ω–∏–π IP:</strong> ${record.lastip}</div>` : ''}
                ${record.username ? `<div class="record-field"><strong>üë®‚Äçüíª –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</strong> ${record.username}</div>` : ''}
              </div>
              <div class="record-meta">
                <span class="leak-source">–ò—Å—Ç–æ—á–Ω–∏–∫: ${record.database || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</span>
              </div>
            </div>
          `;
        });
        
        if (results.length > 5) {
          html += `<p class="more-results">... –∏ –µ—â–µ ${results.length - 5} –∑–∞–ø–∏—Å–µ–π</p>`;
        }
        
        html += `
            </div>
          </div>
        `;
      });
      
      html += `</div>`;
      
      corporateResults.innerHTML = html;
    }
    
    // –ú–∞—Å—Å–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
    async function performBatchSearch() {
      const batchData = document.getElementById('batchData').value.trim();
      
      if (!batchData) {
        alert('–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏');
        return;
      }
      
      const lines = batchData.split('\n').filter(line => line.trim().length > 0);
      
      if (lines.length === 0) {
        alert('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏');
        return;
      }
      
      if (lines.length > 100) {
        alert('–ú–∞–∫—Å–∏–º—É–º 100 –∑–∞–ø–∏—Å–µ–π –∑–∞ —Ä–∞–∑');
        return;
      }
      
      batchSearchBtn.disabled = true;
      batchSearchBtn.textContent = 'üîÑ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º...';
      corporateResults.innerHTML = '';
      showCorporateProgress();
      
      try {
        console.log('üìã Starting batch search for', lines.length, 'items');
        
        const batchResults = [];
        
        for (let i = 0; i < lines.length; i++) {
          const item = lines[i].trim();
          const progress = (i / lines.length) * 100;
          
          updateCorporateProgress(progress, `–ü—Ä–æ–≤–µ—Ä—è–µ–º ${i + 1} –∏–∑ ${lines.length}: ${item.substring(0, 20)}...`);
          
          // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
          const field = detectDataType(item);
          
          try {
            // –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–º –∏—Å—Ç–æ—á–Ω–∏–∫–µ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
            const response = await fetch('/api/leak-search-step', {
              method: 'POST',
              headers: createAuthHeaders(),
              body: JSON.stringify({
                query: item,
                field: field,
                step: 1, // –¢–æ–ª—å–∫–æ ITP –¥–ª—è –±—ã—Å—Ç—Ä–æ—Ç—ã
                mode: 'batch'
              })
            });

            const stepData = await response.json();
            batchResults.push({
              query: item,
              field: field,
              result: stepData.result || { ok: false, error: stepData.error }
            });
            
          } catch (error) {
            batchResults.push({
              query: item,
              field: field,
              result: { ok: false, error: error.message }
            });
          }
          
          // –ü–∞—É–∑–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
          await new Promise(resolve => setTimeout(resolve, 200));
        }
        
        updateCorporateProgress(100, '–ó–∞–≤–µ—Ä—à–µ–Ω–æ');
        
        setTimeout(() => {
          hideCorporateProgress();
          displayBatchResults(batchResults);
        }, 500);
        
      } catch (error) {
        console.error('Batch search error:', error);
        hideCorporateProgress();
        corporateResults.innerHTML = `
          <div class="result-card">
            <div style="color: #dc2626;">
              <strong>‚ùå –û—à–∏–±–∫–∞ –º–∞—Å—Å–æ–≤–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏</strong><br>
              ${error.message}
            </div>
          </div>
        `;
      } finally {
        batchSearchBtn.disabled = false;
        batchSearchBtn.textContent = 'üìä –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∞—Å—Å–æ–≤—É—é –ø—Ä–æ–≤–µ—Ä–∫—É';
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö
    function detectDataType(data) {
      if (/^\+?[0-9\s\-\(\)]{10,}$/.test(data)) {
        return 'phone';
      } else if (/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(data)) {
        return 'email';
      } else if (/^\d{10,12}$/.test(data)) {
        return 'inn';
      } else if (/vk\.com|vkontakte\.ru/.test(data)) {
        return 'vk';
      } else {
        return 'email'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
      }
    }
    
    // –§—É–Ω–∫—Ü–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    function displayCorporateCompanyResults(data, inn, name) {
      const searchQuery = inn || name;
      
      corporateResults.innerHTML = `
        <div class="result-card" style="border: 2px solid #1f2937;">
          <div class="result-header">
            <div class="result-title">üè¢ –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑: ${searchQuery}</div>
            <span class="status-badge ${data.success ? 'status-clean' : 'status-error'}">
              ${data.success ? '–ó–∞–≤–µ—Ä—à–µ–Ω' : '–û—à–∏–±–∫–∞'}
            </span>
          </div>
          <div class="result-body" style="display: block;">
            ${data.success ? formatResultData(data.result || {}) : `<div style="color: #dc2626;">${data.error}</div>`}
          </div>
        </div>
        
        <div class="mt-8 p-6 bg-gray-50 border-2 border-gray-200">
          <h3 class="text-lg font-bold mb-4">üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <button class="btn-secondary w-full" onclick="alert('üöß –§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">
              üìä –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑
            </button>
            <button class="btn-secondary w-full" onclick="alert('üöß –§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">
              üë• –ê–Ω–∞–ª–∏–∑ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞
            </button>
            <button class="btn-secondary w-full" onclick="alert('üöß –§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">
              üîç –£–≥–ª—É–±–ª–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
            </button>
            <button class="btn-secondary w-full" onclick="alert('üöß –§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">
              üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π
            </button>
          </div>
        </div>
      `;
    }
    
    function displayEmployeeResults(results, query, field) {
      let html = `
        <div class="result-card" style="border: 2px solid #1f2937;">
          <div class="result-header">
            <div class="result-title">üë§ –ê–Ω–∞–ª–∏–∑ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: ${query}</div>
            <span class="status-badge status-clean">–ó–∞–≤–µ—Ä—à–µ–Ω</span>
          </div>
          <div class="result-body" style="display: block;">
            <div class="data-grid">
              <div class="data-label">üîç –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö</div>
              <div class="data-value">${getFieldName(field)}</div>
              <div class="data-label">üìä –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤</div>
              <div class="data-value">${results.length}</div>
            </div>
          </div>
        </div>
      `;
      
      // –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
      results.forEach(result => {
        const sourceName = result.name;
        let status = 'success';
        
        if (result.error) {
          status = 'warning';
        } else if (result.ok && result.items) {
          const hasData = window.checkIfSourceHasLeakData(result, sourceName);
          if (hasData) {
            status = 'danger';
          }
        }
        
        const item = createResultItem(`üë§ ${sourceName}`, status, result.items || result.error);
        html += item.outerHTML;
      });
      
      corporateResults.innerHTML = html;
    }
    
    function displayBatchResults(results) {
      const totalItems = results.length;
      const foundItems = results.filter(r => r.result.ok && r.result.items).length;
      const errorItems = results.filter(r => !r.result.ok).length;
      
      let html = `
        <div class="result-card" style="border: 2px solid #1f2937;">
          <div class="result-header">
            <div class="result-title">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∞—Å—Å–æ–≤–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏</div>
            <span class="status-badge status-clean">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</span>
          </div>
          <div class="result-body" style="display: block;">
            <div class="data-grid">
              <div class="data-label">üìù –í—Å–µ–≥–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ</div>
              <div class="data-value">${totalItems}</div>
              <div class="data-label">üö® –ù–∞–π–¥–µ–Ω–æ —É—Ç–µ—á–µ–∫</div>
              <div class="data-value" style="color: ${foundItems > 0 ? '#dc2626' : '#059669'};">${foundItems}</div>
              <div class="data-label">‚ùå –û—à–∏–±–æ–∫</div>
              <div class="data-value">${errorItems}</div>
              <div class="data-label">‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ</div>
              <div class="data-value">${totalItems - foundItems - errorItems}</div>
            </div>
          </div>
        </div>
      `;
      
      // –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
      results.forEach((item, index) => {
        let status = 'success';
        let statusText = '–ß–∏—Å—Ç–æ';
        
        if (!item.result.ok) {
          status = 'warning';
          statusText = '–û—à–∏–±–∫–∞';
        } else if (item.result.items && window.checkIfSourceHasLeakData(item.result, 'ITP')) {
          status = 'danger';
          statusText = '–ù–∞–π–¥–µ–Ω–æ';
        }
        
        html += `
          <div class="result-card">
            <div class="result-header" onclick="toggleResult(this)">
              <div class="result-title">${index + 1}. ${item.query} (${getFieldName(item.field)})</div>
              <div class="flex items-center gap-3">
                <span class="status-badge ${status === 'success' ? 'status-clean' : status === 'danger' ? 'status-found' : 'status-error'}">${statusText}</span>
                <span class="caret">‚ñ∂</span>
              </div>
            </div>
            <div class="result-body">
              ${typeof item.result.items === 'string' ? item.result.items : 
                (() => {
                  // –í –º–∞—Å—Å–æ–≤–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –æ—Ç ITP
                  const sourceName = 'ITP';
                  console.log('üéØ Batch result formatting for source:', sourceName, {
                    itemsType: typeof item.result.items,
                    itemsLength: Array.isArray(item.result.items) ? item.result.items.length : 'not array'
                  });
                  return formatResultDataBySource(item.result.items || item.result.error, sourceName);
                })()}
            </div>
          </div>
        `;
      });
      
      corporateResults.innerHTML = html;
    }
    
    function getFieldName(field) {
      const fieldNames = {
        'phone': '–¢–µ–ª–µ—Ñ–æ–Ω',
        'email': 'Email',
        'fullname': '–§–ò–û',
        'vk': 'VK –ø—Ä–æ—Ñ–∏–ª—å',
        'inn': '–ò–ù–ù'
      };
      return fieldNames[field] || field;
    }
  </script>

  <!-- AI Loading Overlay -->
  <div id="aiLoadingOverlay" class="ai-loading-overlay">
    <div class="ai-loading-content">
      <div class="ai-loading-title">ü§ñ –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ò–ò</div>
      <div class="ai-loading-subtitle">–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–∞–π–¥–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é...</div>
      
      <div class="ai-spinner"></div>
      
      <div class="ai-progress-dots">
        <div class="ai-dot"></div>
        <div class="ai-dot"></div>
        <div class="ai-dot"></div>
      </div>
      
      <div id="aiStatusText" class="ai-status-text">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</div>
    </div>
  </div>

</body>
</html>